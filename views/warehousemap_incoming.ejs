<!DOCTYPE html>
<html lang="en">

<head>
    <%- include('./partials/head'); -%>
    <style>
        /* .cv-tbl tr,td,th{
            border: 1px solid;
            width: 200%;
        } */

        /* .cv-tbl td{ */
            /* border: 1px solid; */
            /* width: 100%; */
        /* } */
        
        /* .center { */
          /* text-align: center; */
        /* } */
        
        
        /* .table-responsive { */
            /* overflow-x: scroll; */
            /* max-width: 100%; */
        /* } */
        
        /* .vertical-text {
            writing-mode: vertical-lr;
            text-orientation: sideways;
        } */


        table, th, td {
            border: 1px solid black;
        }


        /* styles.css */
      /* body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
      } */

      /* .hover-text {
        cursor: pointer;
        text-decoration: underline;
      } */

      .modal {
          display: none; /* Hidden by default */
          position: fixed; /* Stay in place */
          z-index: 9999999999999; /* Sit on top */
          padding-top: 100px; /* Location of the box */
          left: 0;
          top: 0;
        
          
        }
        
        /* Modal Content */
        .modal-content {
          position: relative;
          background-color: #fefefe;
          margin: auto;
          padding: 0;
          border: 1px solid #888;
          width: 50%;
          box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);
          -webkit-animation-name: animatetop;
          -webkit-animation-duration: 0.4s;
          animation-name: animatetop;
          animation-duration: 0.4s
        }
        
        /* Add Animation */
        @-webkit-keyframes animatetop {
          from {top:-300px; opacity:0} 
          to {top:0; opacity:1}
        }
        
        @keyframes animatetop {
          from {top:-300px; opacity:0}
          to {top:0; opacity:1}
        }
        
        /* The Close Button */
        .close {
          color: white;
          float: right;
          font-size: 28px;
          font-weight: bold;
        }
        
        .close:hover,
        .close:focus {
          color: #000;
          text-decoration: none;
          cursor: pointer;
        }
        
        .modal-header {
          padding: 2px 16px;
          background-color: rgba(34, 34, 51, 0.705);
          color: white;
        }
        
        .modal-body {padding: 2px 16px;}
        
        .modal-footer {
          padding: 2px 16px;
          background-color: rgba(34, 34, 51, 0.705);
          color: white;
          display: flex;
          justify-content: center;
          display: grid;
            place-items: center;
        }


        .emailcontainer {
            display: none;
            position: absolute;
            /* top: 40px;
            left: 20px; */
            background-color: rgb(255, 255, 255);
            color:#000000;
            border:solid 1px #000000;
            padding:10px;
            /* padding-left:50px; */
            /* padding-right:200px; */
            overflow-x: auto; 
            z-index: 9999999999999;
        }
        table td {
            word-wrap: break-word;
            white-space: nowrap;
            /* overflow: hidden; */
            text-overflow: ellipsis;
        }

        /* .button-text { */
            /* padding:0 25px; */
            /* line-height:56px; */
            /* letter-spacing:3px */
        /* } */
        .button-text.contactme {
            position: relative;
            /* font-weight:50px; */
}

    </style>
</head>

<body onload="LogicDropdown(); SelectRoom(); ">
    <!--*******************
    Preloader start
********************-->
    <div id="preloader">
        <div class="sk-three-bounce">
            <div class="sk-child sk-bounce1"></div>
            <div class="sk-child sk-bounce2"></div>
            <div class="sk-child sk-bounce3"></div>
        </div>
    </div>
    <!--*******************
    Preloader end
********************-->

    <!--**********************************
    Main wrapper start
***********************************-->
    <div id="main-wrapper" >

        <!--**********************************
        Nav header start
    ***********************************-->
        <%- include('./partials/header_logo'); -%>

            <!--**********************************
        Nav header end
    ***********************************-->

            <!--**********************************
        Header start
    ***********************************-->
            <%- include('./partials/header',{titel: language.WareHouse_Map}); -%>

                <!--**********************************
        Header end ti-comment-alt
    ***********************************-->

                <!--**********************************
        Sidebar start
    ***********************************-->
                <%- include('./partials/sidebar'); -%>

                    <!--**********************************
        Sidebar end
    ***********************************-->

                    <div class="content-body" >
                        <div class="card">
                            <div class="container-fluid">
                                <div class="card-header">
                                            <h4 class="card-title">Warehouse Map</h4>
                                             
                                         
                                </div>
                                
                                <div class="card-header" style="display: flex; flex-direction: column; align-items: center;">
                                <div class="row">


                                  <div class="mb-3 col-md-4">
                                    <label for="warrehouse">Category <span class="text-red">*</span> </label>
                                    <select class="form-control" name="A" id="A" onchange="LogicDropdown()" required>
                                    
                                        <option value="raw" >Raw Materials</option>
                                        <option value="finish" >Finished Goods</option>
                                    </select>
                                  </div>


                                  <div class="mb-3 col-md-4">
                                    <label for="warrehouse"> Type <span class="text-red">*</span> </label>
                                    <select class="form-control" name="B" id="B" onchange="SelectRoomSelect();" required>
                                      <!-- <option value="All" >ALL</option>
                                        <option value="pack" >Packaging</option>
                                        <option value="ingre" >Ingridients</option> -->
                                    </select>
                                </div>


                                    <div class="mb-3 col-md-4">
                                        <label for="warrehouse">Warehouse <span class="text-red">*</span> </label>
                                        <select class="form-control" name="warehouse" id="warehouse" onchange="SelectRoom()" required>
                                           
                                            <% warehouse.forEach((data)=> { %>
                                            <option value="<%= data.name %>"><%= data.name %></option>
                                            <% }) %>
                                        </select>
                                    </div>
                                    
                                    
                                    <div class="mb-3 col-md-4">
                                        <label for="warrehouse">Rack <span class="text-red">*</span> </label>
                                        <select class="form-control" name="room" id="room" required>
                                        </select>
                                    </div>
                                    
                                    <div class="mb-3 col-md-4" id="LevelTpes">
                                        <label for="warrehouse">Level <span class="text-red">*</span> </label>
                                        <select class="form-control" name="Type" id="Type" required>
                                        
                                            <option value="Level" >Level</option>
                                            <option value="Floor" >Floor</option>
                                        </select>
                                    </div>
                                </div> 
                                
                                <div class="row">
                                    <button type="submit" class="btn btn-primary w-100" id="filterButton">Generate</button>
                                </div> 
                            </div>
                            
                           
                           <div class="container-fluid">
                            <div class="table-responsive">
                                <table id="dataTable" >
                                    <tbody>
                                   
                                    </tbody>
                                </table>
                            </div>
                        </div>

                           </div>
                       </div>
                    </div>


                    <div id="modal" class="modal">

                      <!-- Modal content -->
                      <div class="modal-content">
                        <div class="modal-header">
                          <span class="close">&times;</span>
                          <h2>Summary</h2>
                        </div>
                        <div class="modal-body">

                          <div>
                              <span style="color:black;">Document Number: <b></b></span>
                          </div>
                          <div>
                              <span style="color:black;">Date received: <b id="dateRec"></b></span>
                          </div>
                          <div>
                              <span style="color:black;">Warehouse: <b id="houseware"></b></span>
                          </div>
                          <div>
                              <span style="color:black;">Room: <b id="moor"></b></span>
                          </div>
                          
                          
                        </div>
                        <div class="table-responsive">
                          <table class="table primary-table-bordered" style="width:100%" id="purchases_tbl_modal">

                          </table>
                        </div>
                        
                        <div class="modal-footer">
                          <button class="btn btn-primary" onclick="saveAndContinue()">Save and Continue</button>
                        </div>
                      </div>
                    
                  </div>


                
                

                    <!--**********************************
            Footer start
        ***********************************-->
                    <%- include('./partials/footer'); -%>

                        <!--**********************************
            Footer end
        ***********************************-->

    <!--**********************************
        Main wrapper end
    ***********************************-->

    <!-- start Toastr -->
    <%- include('./partials/toastr'); -%>
    <!-- End Toastr -->

    <!--**********************************
        Scripts
    ***********************************-->
   
    <%- include('./partials/script'); -%>
    <script>

      


        function SelectRoom(){
        
            var varibale = document.getElementById("warehouse").value;
            var selectRoom = $('#room');
            var AVal = document.getElementById("A").value;
            var BVal = document.getElementById("B").value;

            $.ajax({
                url: '/warehousemap_Income/Rooms_data', 
                method: 'POST',
                data: { warehouse_name: varibale, A:AVal, B:BVal  }, 
                success: function(response) {

                
                    selectRoom.empty();
                    if(AVal == "finish"){
                      var defaultOption = $('<option>').text("All").val("All").attr('roomcode', "All");
                      selectRoom.append(defaultOption);
                    }
                    
                        $.each(response, function(index, data) {
                            var roomName = data.room_name;
                            var roomCode = data.room_name
                            var option = $('<option>').text(roomName).val(roomName).attr('roomcode', roomCode);;
                            selectRoom.append(option);
                            // LogicDropdown();

                        })
                    
                }
            })
            
        }

        function SelectRoomSelect(){
        
        var selectRoom = $('#warehouse');
        var A = document.getElementById("A");
        var BVal = document.getElementById("B").value;

          var CatVal = '';
          var IndiVal = '';
          if(A.value == "raw"){
            // $.ajax({
            //     url: '/warehousemap_Income/Rooms_data2', 
            //     method: 'POST',
            //     data: { cat: "Raw Materials" }, 
            //     success: function(response) {

                
            //         selectRoom.empty();
            //             $.each(response, function(index, data) {
            //                 var roomName = data.room_name;
            //                 var roomCode = data.room_name
            //                 var option = $('<option>').text(roomName).val(roomName).attr('roomcode', roomCode);;
            //                 selectRoom.append(option);


            //             })
            //             SelectRoom()
            //     }
            // })

            CatVal = "Raw Materials";
            
          }else{
            CatVal = "Finished Goods";

          }

          $.ajax({
                url: '/warehousemap_Income/Rooms_data2', 
                method: 'POST',
                data: { cat: CatVal, valNew: BVal }, 
                success: function(response) {

                
                    selectRoom.empty();
                    
                        $.each(response, function(index, data) {
                            var roomName = data.room_name;
                            var roomCode = data.room_name
                            var option = $('<option>').text(roomName).val(roomName).attr('roomcode', roomCode);
                              // alert(option)
                              console.log(option)
                            selectRoom.append(option);


                        })
                        SelectRoom()
                }
            })

          
    }

        // function formatNumber(number) {
         
        //   if (Number.isInteger(number)) {
        //     return number.toString(); // Convert whole number to a string
        //   } else {
        //     // console.log("num",number + " <> " +  Number.isInteger(number))
        //     return number.toFixed(3); // Display number with 2 decimal places
        //   }
        // }

        function formatNumber(number) {
          if (typeof number === 'number') {
            if (Number.isInteger(number)) {
              return number.toString(); // Convert whole number to a string
            } else {
              return number.toFixed(3); // Display number with 3 decimal places
            }
          } else {
            console.log("num", typeof number + " is not a number");
            return number.toString();; // Or handle the non-number case as per your requirements
          }
        }


        function jsonToArray(jsonData) {
            var data = [];
            var A_value = $('#A').val();
            if(A_value == "raw"){
            //  console.log(jsonData)
              jsonData.forEach((item) => {
                
                var bay = parseInt(item.bay);
                var bin = item.bin;
                var floorllevel = parseInt(item.floorlevel);
                var Types = item.type;
                var count = formatNumber(item.totalQuantity);
                if (!data[bay]) {
                  data[bay] = {};
                }

                if (!data[bay][bin]) {
                  data[bay][bin] = {};
                }

                data[bay][bin][floorllevel] = count;
                data[bay]['floorlevel'] = floorllevel;
                

                item.products.forEach((items) => {

                  const prod_name = items.product_name;
                  const prod_qty =  formatNumber(items.product_quantity);
                  const product_code = items.product_code;


                  if (!data["prd_data_name"]) {
                      data["prd_data_name"] = [];
                  }

                  if (!data["prd_data_qty"]) {
                      data["prd_data_qty"] = [];
                  }

                  if (!data["product_code"]) {
                    data["product_code"] = [];
                  }


                  

                  if (!data["prd_data_name"][bay]) {
                      data["prd_data_name"][bay] = [];
                  }

                  if (!data["prd_data_qty"][bay]) {
                      data["prd_data_qty"][bay] = [];
                  }


                  if (!data["product_code"][bay]) {
                    data["product_code"][bay] = [];
                  }

                  if (!data["prd_data_name"][bay][bin]) {
                      data["prd_data_name"][bay][bin] = [];
                  }

                  if (!data["prd_data_qty"][bay][bin]) {
                      data["prd_data_qty"][bay][bin] = [];
                  }

                  if (!data["product_code"][bay][bin]) {
                    data["product_code"][bay][bin] = [];
                  }


                  if (!data["prd_data_name"][bay][bin][Types]) {
                      data["prd_data_name"][bay][bin][Types] = [];
                  }

                  if (!data["prd_data_qty"][bay][bin][Types]) {
                      data["prd_data_qty"][bay][bin][Types] = [];
                  }

                  if (!data["product_code"][bay][bin][Types]) {
                    data["product_code"][bay][bin][Types] = [];
                  }

                  if (!data["prd_data_name"][bay][bin][Types][floorllevel]) {
                      data["prd_data_name"][bay][bin][Types][floorllevel] = [];
                  }

                  if (!data["prd_data_qty"][bay][bin][Types][floorllevel]) {
                      data["prd_data_qty"][bay][bin][Types][floorllevel] = [];
                  }

                  if (!data["product_code"][bay][bin][Types][floorllevel] ) {
                    data["product_code"][bay][bin][Types][floorllevel]  = [];
                  }

                  data["prd_data_name"][bay][bin][Types][floorllevel].push(prod_name);
                  data["prd_data_qty"][bay][bin][Types][floorllevel].push(formatNumber(prod_qty));
                  data["product_code"][bay][bin][Types][floorllevel].push(product_code);
                  // console.log(items)
                });

      
             });
            }else{

              jsonData.forEach((item) => {

                var bay = parseInt(item.bay);
                var count = formatNumber(item.totalQuantity);

                if (!data[bay]) {
                data[bay] = {};
                }

  
                data[bay] = count;
    
                item.products.forEach((items) => {
                  
    

                  if (!data["prd_data_name"]) {
                      data["prd_data_name"] = [];
                  }

                  if (!data["prd_data_qty"]) {
                      data["prd_data_qty"] = [];
                  }

                  if (!data["production_date"]) {
                      data["production_date"] = [];
                  }

                  if (!data["expiry_date"]) {
                      data["expiry_date"] = [];
                  }

                  if (!data["batch_code"]) {
                      data["batch_code"] = [];
                  }


                  if (!data["product_code"]) {
                    data["product_code"] = [];
                  }

                  if (!data["prd_data_name"][bay]) {
                      data["prd_data_name"][bay] = [];
                  }

                  if (!data["product_code"][bay]) {
                    data["product_code"][bay] = [];
                  }

                  if (!data["prd_data_qty"][bay]) {
                      data["prd_data_qty"][bay] = [];
                  }

                  if (!data["production_date"][bay]) {
                      data["production_date"][bay] = [];
                  }

                  if (!data["expiry_date"][bay]) {
                      data["expiry_date"][bay] = [];
                  }

                  if (!data["batch_code"][bay]) {
                      data["batch_code"][bay] = [];
                  }
                  
                  data["prd_data_name"][bay].push(items.product);
                  data["prd_data_qty"][bay].push(formatNumber(items.quantity));
                  data["production_date"][bay].push(items.production_date)
                  data["expiry_date"][bay].push(items.expiry_date)
                  data["batch_code"][bay].push(items.batch_code)
                  data["product_code"][bay].push(items.product_code)
                  

        
                })
                
              
            });
            }
            

            return data;
        }

        function LogicDropdown(){
          var A = document.getElementById("A")
          var B = document.getElementById("B")

          A.addEventListener("change", function() {
          var selectedOptionText = A.options[A.selectedIndex].textContent;
          // console.log(selectedOptionText)
            

          });


          if(A.value == "raw"){
            B.innerHTML = "<option value='ingre'>Ingredients</option><option value='pack'>Packaging</option>"
            $("#LevelTpes").show();
          }else if(A.value == "finish"){
            B.innerHTML = "<option value='All'>All</option>"
            $("#LevelTpes").hide();
            
          }
          SelectRoomSelect();
        }


        $(document).ready(function() {
  // Initialize the DataTable
  dataBody = $('#dataTable tbody');

  // Event handler for the filter button click
  $('#filterButton').click(function() {
    var warehouse_value = $('#warehouse').val();
    var room_value = $('#room').val();
    var Type_value = $('#Type').val();
    var A_value = $('#A').val();
    var B_value = $('#B').val();
    let urldata;
      if(A_value == "raw"){
        urldata = '/warehousemap_Income/MapData';
      }else{
        urldata = '/warehousemap_Income/MapData2';
      }

    // Make an AJAX request to the server
    $.ajax({
      
      url: urldata,
      type: 'POST',
      data: { warehouseNew: warehouse_value, rooms: room_value, Type: Type_value, process_cat: A_value, room_cat: B_value },
      success: function(response) {
        // Clear the existing table data
        dataBody.empty();
        // console.log(response)
        const DataRes = jsonToArray(response);
        // console.log(DataRes)
        let dataIsle = [1,2,3,4,5, 6, 7,8];
        switch(A_value){
          case "raw":
            if(B_value == "pack"){
              switch(warehouse_value) {
                case "DRY STORAGE":

                if(room_value == "Rack A"){
                    if(Type_value == "Level"){
                        var dataItems = '';
                        dataItems = '<tr>';
                        dataIsle.forEach(function(isleItem) {
                          dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + isleItem + ' </strong></center></td>';
                        });

                        dataItems += '</tr>';
                        var datahoverItem = [];
                        for (b = 5; b >= 1; b--) {
                          dataItems += '<tr>';
                          for (c = 1; c <= 8; c++) {
                            for (a = 1; a <= 2; a++) {
                              if (c <= 4 && b <= 5) {
                                if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                  if (parseInt(DataRes[c][a][b]) == 0) {
                                    var sum = 0;
                                  } else {
                                    var sum = DataRes[c][a][b];
                                  }
                                } else {
                                  var sum = 0; 
                                }
                                if (DataRes?.prd_data_name?.[c]?.[a]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Level"][b])) {
                                    const numberOfProducts = DataRes.prd_data_name[c][a]["Level"][b].length;


                 
                                    if (!datahoverItem[c]) {
                                      datahoverItem[c] = {};
                                    }

                                    if (!datahoverItem[c][a]) {
                                      datahoverItem[c][a] = {};
                                    }

                                    datahoverItem[c][a][b] = '';

                                    for (var x = 0; x <= numberOfProducts - 1; x++) {
                                      if (
                                        DataRes &&
                                        DataRes.prd_data_name &&
                                        DataRes.prd_data_name[c] &&
                                        DataRes.prd_data_name[c][a] &&
                                        DataRes.prd_data_name[c][a]["Level"] &&
                                        DataRes.prd_data_name[c][a]["Level"][b] &&
                                        DataRes.prd_data_qty &&
                                        DataRes.prd_data_qty[c] &&
                                        DataRes.prd_data_qty[c][a] &&
                                        DataRes.prd_data_qty[c][a]["Level"] &&
                                        DataRes.prd_data_qty[c][a]["Level"][b]
                                      ) {
                                        datahoverItem[c][a][b] += '<tr>';

                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.product_code[c][a]["Level"][b][x];
                                        datahoverItem[c][a][b] += '</td>';


                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Level"][b][x];
                                        datahoverItem[c][a][b] += '</td>';

                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Level"][b][x];
                                        datahoverItem[c][a][b] += '</td>';
                                        datahoverItem[c][a][b] += '</tr>';

                                      } 
                                    }
                                 
                                  }
                                var color ;
                                if(sum > 0){
                                  color = 'red'
                                }else{
                                  color = 'green'
                                }
                                
                                // dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DA' + c + a + 'L' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[c][a][b] + '</tbody></table></div></td>';
                                if (
                                  datahoverItem &&
                                  datahoverItem[c] &&
                                  datahoverItem[c][a] &&
                                  datahoverItem[c][a][b]
                                ) {
                                  dataItems +=
                                    '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' +
                                    (datahoverItem[c][a][b] ? true : false) +
                                    '"><center><strong> DA' +
                                    c +
                                    a +
                                    'L' +
                                    b +
                                    '</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' +
                                    sum +
                                    '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                    datahoverItem[c][a][b] +
                                    '</tbody></table></div></td>';
                                }else{
                                  dataItems +=
                                    '<td style="height:100px"><center><strong> DA' +
                                    c +
                                    a +
                                    'L' +
                                    b +
                                    '</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' +
                                    sum +
                                    '</b></div></center></td>';
                                }

                              } else if (c > 4) {
                                  if (b <= 4) {
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                     if (parseInt(DataRes[c][a][b]) == 0) {
                                      var sum = 0;
                                     } else {
                                      var sum = parseInt(DataRes[c][a][b]);
                                     }
                                    } else {
                                        var sum = 0; 
                                    }
                                    var color ;
                                    if(sum > 0){
                                      color = 'red'
                                    }else{
                                      color = 'green'
                                    }


                                    if (datahoverItem && datahoverItem[c] && datahoverItem[c][a] && datahoverItem[c][a][b]) {
                                       dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DA' + c + a + 'L' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[c][a][b] +'</tbody></table></div></td>';
                                    }else{
                                      dataItems +='<td style="height:100px"><center><strong> DA' + c + a +'L' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center></td>';
                                    }



                                    // dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DA' + c + a + 'L' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center> <div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[c][a][b] + '</tbody></table></div></td>';
                                 }
                             }
                            }
                          }
                          dataItems += '</tr>';
                        }


                        $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                              // alert($(this).data("has-data"))
                                if ($(this).data("has-data") === true) {
                                    $(this).find('.emailcontainer').show('slow');
                                }
                            }, function () {
                                $(this).find('.emailcontainer').hide('slow');
                            });
                        });
                        dataBody.append(dataItems);
                    }else if (Type_value == "Floor") {
                      var dataItems = '';
                      dataItems = '<tr>';
                        dataIsle.forEach(function(isleItem) {
                          
                          dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + isleItem + ' </strong></center></td>';
                         
                        });
                        var datahoverItem = [];
                        for (b = 1; b <= 2; b++) {
                          dataItems += '<tr>';
                          for (c = 1; c <= 8; c++) {
                            for (a = 1; a <= 2; a++) {
                                if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                  if (parseInt(DataRes[c][a][b]) == 0) {
                                    var sum = 0;
                                  } else {
                                    var sum = parseInt(DataRes[c][a][b]);
                                  }
                                } else {
                                  var sum = 0; 
                                }

                                
                                if (DataRes?.prd_data_name?.[c]?.[a]?.["Floor"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Floor"][b])) {
                                    const numberOfProducts = DataRes.prd_data_name[c][a]["Floor"][b].length;
                                    

                 
                                    if (!datahoverItem[c]) {
                                      datahoverItem[c] = {};
                                    }

                                    if (!datahoverItem[c][a]) {
                                      datahoverItem[c][a] = {};
                                    }

                                    datahoverItem[c][a][b] = '';

                                    for (var x = 0; x <= numberOfProducts - 1; x++) {
                                      if (
                                        DataRes &&
                                        DataRes.prd_data_name &&
                                        DataRes.prd_data_name[c] &&
                                        DataRes.prd_data_name[c][a] &&
                                        DataRes.prd_data_name[c][a]["Floor"] &&
                                        DataRes.prd_data_name[c][a]["Floor"][b] &&
                                        DataRes.prd_data_qty &&
                                        DataRes.prd_data_qty[c] &&
                                        DataRes.prd_data_qty[c][a] &&
                                        DataRes.prd_data_qty[c][a]["Floor"] &&
                                        DataRes.prd_data_qty[c][a]["Floor"][b]
                                      ) {
                                        datahoverItem[c][a][b] += '<tr>';

                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.product_code[c][a]["Floor"][b][x];
                                        datahoverItem[c][a][b] += '</td>';


                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Floor"][b][x];
                                        datahoverItem[c][a][b] += '</td>';

                                        datahoverItem[c][a][b] += '<td>';
                                        datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Floor"][b][x];
                                        datahoverItem[c][a][b] += '</td>';
                                        datahoverItem[c][a][b] += '</tr>';

                                      } 
                                    }

                                    
                                 
                                  }


                                  var color ;
                                  if(sum > 0){
                                    color = 'red'
                                  }else{
                                    color = 'green'
                                 }

                                if (datahoverItem && datahoverItem[c] && datahoverItem[c][a] && datahoverItem[c][a][b]) {
                                  console.log("asdadasdas")
                                    dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DA' + c + a + 'F' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[c][a][b] +'</tbody></table></div></td>';
                                }else{
                                  
                                  dataItems +='<td style="height:100px"><center><strong> DA' + c + a +'F' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center></td>';
                                }
                                // dataItems += '<td style="height:100px"><center><strong> DA' + c + a + 'F' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';

                            }
                          }
                          dataItems += '</tr>';
                        }

                        dataItems += '</tr>';
                      dataBody.append(dataItems);

                      $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                              // alert($(this).data("has-data"))
                                if ($(this).data("has-data") === true) {
                                    $(this).find('.emailcontainer').show('slow');
                                }
                            }, function () {
                                $(this).find('.emailcontainer').hide('slow');
                            });
                        });
                    }
            
           
                }

                break;
              }

            }else if(B_value == "ingre"){
              switch(warehouse_value) {
                case "DRY STORAGE":
                    if(room_value == "Rack B"){
                      let Brack = [6,5,4,3,2,1]
                      if(Type_value == "Level"){
                        var dataItems = '';
                            dataItems = '<tr>';
                              Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem = [];
                            for (b = 1; b <= 4; b++) {
                              dataItems += '<tr>';
                              for (c = 6; c >= 1; c--) {
                                for (a = 2; a >= 1; a--) {
                                  
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                      if (parseInt(DataRes[c][a][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c][a][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }

                                    if (DataRes?.prd_data_name?.[c]?.[a]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c][a]["Level"][b].length;
                                        

                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c][a]) {
                                          datahoverItem[c][a] = {};
                                        }

                                        datahoverItem[c][a][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c][a] &&
                                            DataRes.prd_data_name[c][a]["Level"] &&
                                            DataRes.prd_data_name[c][a]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c][a] &&
                                            DataRes.prd_data_qty[c][a]["Level"] &&
                                            DataRes.prd_data_qty[c][a]["Level"][b]
                                          ) {
                                            datahoverItem[c][a][b] += '<tr>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.product_code[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';


                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';
                                            datahoverItem[c][a][b] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                      }
                                      var color ;
                                      
                                      if(sum > 0){
                                        color = 'red'
                                      }else{
                                        color = 'green'
                                      }
                                      if (datahoverItem && datahoverItem[c] && datahoverItem[c][a] && datahoverItem[c][a][b]) {
                              
                                          dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DB' + c + a + 'L' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[c][a][b] +'</tbody></table></div></td>';
                                      }else{
                                        
                                        dataItems +='<td style="height:100px"><center><strong> DB' + c + a +'L' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center></td>';
                                    }

                                    // dataItems += '<td style="height:100px"><center><strong> DB' + c + a + 'L' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';
                                  
                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                            dataBody.append(dataItems);


                            $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });


                      }else if(Type_value == "Floor"){
                          var dataItems = '';
                          dataItems = '<tr>';
                            Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem = [];
                            for (b = 1; b <= 1; b++) {
                              dataItems += '<tr>';
                              for (c = 6; c >= 1; c--) {
                                for (a = 2; a >= 1; a--) {
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                      if (parseInt(DataRes[c][a][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c][a][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }


                                    if (DataRes?.prd_data_name?.[c]?.[a]?.["Floor"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Floor"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c][a]["Floor"][b].length;
                                        

                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c][a]) {
                                          datahoverItem[c][a] = {};
                                        }

                                        datahoverItem[c][a][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c][a] &&
                                            DataRes.prd_data_name[c][a]["Floor"] &&
                                            DataRes.prd_data_name[c][a]["Floor"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c][a] &&
                                            DataRes.prd_data_qty[c][a]["Floor"] &&
                                            DataRes.prd_data_qty[c][a]["Floor"][b]
                                          ) {
                                            datahoverItem[c][a][b] += '<tr>';
                                            
                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.product_code[c][a]["Floor"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Floor"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Floor"][b][x];
                                            datahoverItem[c][a][b] += '</td>';
                                            datahoverItem[c][a][b] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                      }
                                      var color ;
                                      if(sum > 0){
                                        color = 'red'
                                      }else{
                                        color = 'green'
                                      }


                                    if (datahoverItem && datahoverItem[c] && datahoverItem[c][a] && datahoverItem[c][a][b]) {
                              
                                        dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c][a][b] ? true : false) + '"><center><strong> DB' + c + a + 'F' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[c][a][b] +'</tbody></table></div></td>';
                                    }else{
                                      
                                      dataItems +='<td style="height:100px"><center><strong> DB' + c + a +'F' + b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum +'</b></div></center></td>';
                                  }
                                    // dataItems += '<td style="height:100px"><center><strong> DB' + c + a + 'F' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';

                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                          dataBody.append(dataItems);

                          $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });

                        }
                    }else if(room_value == "Receiving Area"){
                      
                        if(Type_value == "Floor"){
                            var dataItems = ''
                            dataItems = '<tr><td style="width: 400px; height: 500px" colspan= "3"> <center style="color:black"><h1><b>RECEIVING AREA</b></h1></center></td></tr>';
                            
        
                            var r = 5;
                            var c = 3;
                            var num = 17;
                            var sum = 1;
                            // var dataItems = '';
                            var datahoverItem = [];
                            for (a = 0; a < r; a++) {
                              dataItems += '<tr>';
                              for (b = 0; b < c; b++) {
                                  if (sum < num) {
                                      var florArea = (a * c + b + 1);
                                      if (typeof DataRes[0] !== 'undefined' && typeof DataRes[0][0] !== 'undefined' && typeof DataRes[0][0][florArea] !== 'undefined') {
                                        if (parseInt(DataRes[0][0][florArea]) == 0) {
                                          var sum1 = 0;
                                        } else {
                                          var sum1 = parseInt(DataRes[0][0][florArea]);
                                        }
                                      } else {
                                        var sum1 = 0; 
                                      }

                                      if (DataRes?.prd_data_name?.[0]?.[0]?.["Floor"]?.[florArea] && Array.isArray(DataRes.prd_data_name[0][0]["Floor"][florArea])) {
                                        const numberOfProducts = DataRes.prd_data_name[0][0]["Floor"][florArea].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[0]) {
                                          datahoverItem[0] = {};
                                        }

                                        if (!datahoverItem[0][0]) {
                                          datahoverItem[0][0] = {};
                                        }

                                        datahoverItem[0][0][0] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[0] &&
                                            DataRes.prd_data_name[0][0] &&
                                            DataRes.prd_data_name[0][0]["Floor"] &&
                                            DataRes.prd_data_name[0][0]["Floor"][florArea] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[0] &&
                                            DataRes.prd_data_qty[0][0] &&
                                            DataRes.prd_data_qty[0][0]["Floor"] &&
                                            DataRes.prd_data_qty[0][0]["Floor"][florArea]
                                          ) {
                                            datahoverItem[0][0][florArea] += '<tr>';

                                            datahoverItem[0][0][florArea] += '<td>';
                                            datahoverItem[0][0][florArea] += DataRes.product_code[0][0]["Floor"][florArea][x];
                                            datahoverItem[0][0][florArea] += '</td>';


                                            datahoverItem[0][0][florArea] += '<td>';
                                            datahoverItem[0][0][florArea] += DataRes.prd_data_name[0][0]["Floor"][florArea][x];
                                            datahoverItem[0][0][florArea] += '</td>';

                                            datahoverItem[0][0][florArea] += '<td>';
                                            datahoverItem[0][0][florArea] += DataRes.prd_data_qty[0][0]["Floor"][florArea][x];
                                            datahoverItem[0][0][florArea] += '</td>';
                                            datahoverItem[0][0][florArea] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                      }
                                      var color ;
                                      if(sum1 > 0){
                                        color = 'red'
                                      }else{
                                        color = 'green'
                                    }
                                  // dataItems += '<td style="height:100px"><center><strong>DRF' + (a * c + b + 1) + 'asasas</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum1 + '</b></div></center></td>';
                                  if (datahoverItem && datahoverItem[0] && datahoverItem[0][0] && datahoverItem[0][0][florArea]) {
                              
                                      dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][florArea] ? true : false) + '"><center><strong> DRF' + florArea +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum1 +'</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[0][0][florArea] +'</tbody></table></div></td>';
                                  }else{
                                    
                                    dataItems +='<td style="height:100px"><center><strong> DRF' +(a * c + b + 1) +' </strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum1 +'</b></div></center></td>';
                                  }
                                  sum++;
                                  } else {
                                  break; // Exit the loop if the desired number of boxes is reached
                                  }
                              }
                              dataItems += '</tr>';
                              if (sum >= num) break; // Exit the loop if the desired number of boxes is reached
                            }

                            if (sum < num) {
                            dataItems += '<tr>';
                            for (b = 0; b < c; b++) {
                                if (sum < num) {


                                  var florArea = (a * c + b + 1);
                                      if (typeof DataRes[0] !== 'undefined' && typeof DataRes[0][0] !== 'undefined' && typeof DataRes[0][0][florArea] !== 'undefined') {
                                        if (parseInt(DataRes[0][0][florArea]) == 0) {
                                          var sum1 = 0;
                                        } else {
                                          var sum1 = parseInt(DataRes[0][0][florArea]);
                                        }
                                      } else {
                                        var sum1 = 0; 
                                      }

                                      var color ;
                                      if(sum1 > 0){
                                        color = 'red'
                                      }else{
                                        color = 'green'
                                    }
                                      

                                  
                                dataItems +=
                                    '<td style="height:100px"><center><strong>DRF' +
                                    (a * c + b + 1) +
                                    '</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' +
                                      sum1 +
                                    '</b></div></center></td>';
                                sum++;
                                } else {
                                dataItems +=
                                    '<td style="height:100px"></td>'; // Fill empty cells if num is smaller than the total number of cells
                                }
                            }
                            dataItems += '</tr>';
                            }
                            dataBody.append(dataItems);


                            $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });

                        
                        }
                    }else if(room_value == "Shelves"){
                      if(Type_value == "Floor"){
                        // alert(DataRes[0][0][3])
                        // if (typeof DataRes !== "undefined" && DataRes.length > 0 && DataRes[0].length > 0) {
                          // var F1 = typeof DataRes[0][0][1] !== "undefined" ? DataRes[0][0][1] : 0;
                          // var F3 = typeof DataRes[0][0][3] !== "undefined" ? DataRes[0][0][3] : 0;
                          // var F2 = typeof DataRes[0][0][2] !== "undefined" ? DataRes[0][0][2] : 0;
                          // var F4 = typeof DataRes[0][0][4] !== "undefined" ? DataRes[0][0][4] : 0;
                          // var F5 = typeof DataRes[0][0][5] !== "undefined" ? DataRes[0][0][5] : 0;
                          // var F6 = typeof DataRes[0][0][6] !== "undefined" ? DataRes[0][0][6] : 0;


                          var F = [];
                          var datahoverItem = [];
                          for (var i = 1; i <= 6; i++) {
                            // F[i] = typeof DataRes[0][0][i] !== "undefined" ? DataRes[0][0][i] : 0;
                            F[i] = DataRes[0][0][i] !== undefined ? DataRes[0][0][i] : 0;
                            // alert(DataRes[0][0][i])
                            // if (DataRes && Array.isArray(DataRes[0]) && Array.isArray(DataRes[0][0])) {
                            //     F[i] = DataRes[0][0][i] !== undefined ? DataRes[0][0][i] : 0;
                            //     alert("here")
                            // } else {
                            //     F[i] = 0;
                            // }



                            if (DataRes?.prd_data_name?.[0]?.[0]?.["Floor"]?.[i] && Array.isArray(DataRes.prd_data_name[0][0]["Floor"][i])) {
                                        const numberOfProducts = DataRes.prd_data_name[0][0]["Floor"][i].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[0]) {
                                          datahoverItem[0] = {};
                                        }

                                        if (!datahoverItem[0][0]) {
                                          datahoverItem[0][0] = {};
                                        }

                                        datahoverItem[0][0][i] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[0] &&
                                            DataRes.prd_data_name[0][0] &&
                                            DataRes.prd_data_name[0][0]["Floor"] &&
                                            DataRes.prd_data_name[0][0]["Floor"][i] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[0] &&
                                            DataRes.prd_data_qty[0][0] &&
                                            DataRes.prd_data_qty[0][0]["Floor"] &&
                                            DataRes.prd_data_qty[0][0]["Floor"][i]
                                          ) {
                                            datahoverItem[0][0][i] += '<tr>';

                                            datahoverItem[0][0][i] += '<td>';
                                            datahoverItem[0][0][i] += DataRes.product_code[0][0]["Floor"][i][x];
                                            datahoverItem[0][0][i] += '</td>';


                                            datahoverItem[0][0][i] += '<td>';
                                            datahoverItem[0][0][i] += DataRes.prd_data_name[0][0]["Floor"][i][x];
                                            datahoverItem[0][0][i] += '</td>';

                                            datahoverItem[0][0][i] += '<td>';
                                            datahoverItem[0][0][i] += DataRes.prd_data_qty[0][0]["Floor"][i][x];
                                            datahoverItem[0][0][i] += '</td>';
                                            datahoverItem[0][0][i] += '</tr>';

                                          } 
                                        }

                                        
                                    
                            }
                            else{
                              if (!datahoverItem[0]) {
                                datahoverItem[0] = {};
                              }

                              if (!datahoverItem[0][0]) {
                                datahoverItem[0][0] = {};
                              }
                              datahoverItem[0][0][i] = '';

                              datahoverItem[0][0][i] += '';
                            }

                            // alert(datahoverItem[0][0][i])
                          }
                          
                        // } else {
                        //   var F1 = 0;
                        //   var F3 = 0;
                        //   var F2 = 0;
                        //   var F4 = 0;
                        //   var F5 = 0;
                        //   var F6 = 0;
                        // }
                        var color ;
                        if(sum1 > 0){
                          color = 'red'
                        }else{
                          color = 'green'
                        }

                        var dataItems ='';
                        dataItems += '<tr>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][6] ? true : false) + '"><center><strong>DB1SF6</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[6] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][6] + '</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][5] ? true : false) + '"><center><strong>DB1SF5</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[5] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][5] + '</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][4] ? true : false) + '"><center><strong>DB1SF4</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][4] + '</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][3] ? true : false) + '"><center><strong>DB1SF3</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][3] + '</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataItems += '<tr>';
                        dataItems += '<td colspan="2" style="width: 200px; height: 150px" > <center style="color:black"><h1><b> SHELVES </b></h1></center> </td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][2] ? true : false) + '"><center><strong>DB1SF2</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][2] + '</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0][0][1] ? true : false) + '"><center><strong>DB1SF1</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[0][0][1] + '</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataBody.append(dataItems);

                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }

                    }
                break;

                case "COLD STORAGE":
                if(room_value == "Rack A"){
                      let Brack = [1,2,3,4,5,6,7]
                      if(Type_value == "Level"){
          
                        var dataItems = '';
                        dataItems = '<tr>';
                        Brack.forEach(function(BItem) {

                          dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';

                        });
                        var datahoverItem = [];
                        for (b = 5; b >= 1; b--) {
                          dataItems += '<tr>';
                          for (c = 1; c <= 7; c++) {
                            for (a = 1; a >= 1; a--) {

                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["B"] !== 'undefined' && typeof DataRes[c]["B"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["B"][b]) == 0) {
                                  var sumA = 0;
                                } else {
                                  var sumA = parseInt(DataRes[c]["B"][b]);
                                }
                              } else {
                                var sumA = 0; 
                              }

                            

                              if (DataRes?.prd_data_name?.[c]?.["B"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["B"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["B"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["B"]) {
                                          datahoverItem[c]["B"] = {};
                                        }

                                        datahoverItem[c]["B"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["B"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["B"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["B"][b] += '<tr>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.product_code[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';


                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_name[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_qty[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';
                                            datahoverItem[c]["B"][b] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                }


                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["F"] !== 'undefined' && typeof DataRes[c]["F"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["F"][b]) == 0) {
                                  var sumB = 0;
                                } else {
                                  var sumB = parseInt(DataRes[c]["F"][b]);
                                }
                              } else {
                                var sumB = 0; 
                              }



                              if (DataRes?.prd_data_name?.[c]?.["F"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["F"]) {
                                          datahoverItem[c]["F"] = {};
                                        }

                                        datahoverItem[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["F"][b] += '<tr>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.product_code[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';


                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            datahoverItem[c]["F"][b] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                }

                              dataItems += '<td style="height:100px">';
                              // dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c]["B"][b] ? true : false) + '"><center><strong> CA' + c + 'B' + 'L' + b + '</strong> <div style="background-color: #f0f0f0; width: 200px; height: 25px; margin: 0 auto;"><b>' + sumA + '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[c]["B"][b] + '</tbody></table></div></div>';
                              var colora ;
                              if(sumA > 0){
                                colora = 'red'
                              }else{
                                colora = 'green'
                              }

                              var colorb ;
                              if(sumB > 0){
                                colorb = 'red'
                              }else{
                                colorb = 'green'
                              }

                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["B"] && datahoverItem[c]["B"][b]) {
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["B"][b] ? true : false) +
                                  '"><center><strong> CA' +
                                  c +
                                  'B' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                  sumA +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["B"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CA' + c + 'B' + 'L' + b + '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumA + '</b></div> </center></div>';
                              }


                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["F"] && datahoverItem[c]["F"][b]) {
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["F"][b] ? true : false) +
                                  '"><center><strong> CA' +
                                  c +
                                  'F' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                  sumB +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["F"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CA' + c + 'F' + 'L' + b + '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumB + '</b></div></center></div>';
                              }

                              // dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CA' + c + 'F' + 'L' + b + '</strong> <div style="background-color: #f0f0f0; width: 200px; height: 25px; margin: 0 auto;"><b>' + sumB + '</b></div></center></div>';
                              dataItems += '</td>';

                            }
                          }
                          dataItems += '</tr>';
                        }

                        dataItems += '</tr>';
                        dataBody.append(dataItems);

                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });


                      }else if(Type_value == "Floor"){
                        var dataItems = '';
                          dataItems = '<tr>';
                            let Brack = [1,2,3,4,5]
                            Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });

                            var datahoverItem = [];
                            for (b = 2; b >= 1; b--) {
                              dataItems += '<tr>';
                              for (c = 1; c <= 5; c++) {
                                for (a = 1; a >= 1; a--) {
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["F"] !== 'undefined' && typeof DataRes[c]["F"][b] !== 'undefined') {
                                      if (parseInt(DataRes[c]["F"][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c]["F"][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }


                                    if (DataRes?.prd_data_name?.[c]?.["F"]?.["Floor"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Floor"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Floor"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["F"]) {
                                          datahoverItem[c]["F"] = {};
                                        }

                                        datahoverItem[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Floor"] &&
                                            DataRes.prd_data_name[c]["F"]["Floor"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Floor"] &&
                                            DataRes.prd_data_qty[c]["F"]["Floor"][b]
                                          ) {
                                            datahoverItem[c]["F"][b] += '<tr>';


                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.product_code[c]["F"]["Floor"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            
                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Floor"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Floor"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            datahoverItem[c]["F"][b] += '</tr>';

                                          } 
                                        }

                                        
                                    
                                }
                                var colora ;
                                if(sum > 0){
                                  colora = 'red'
                                }else{
                                  colora = 'green'
                                }

                                if (datahoverItem && datahoverItem[c] && datahoverItem[c]["F"] && datahoverItem[c]["F"][b]) {
                                  dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[c]["F"][b] ? true : false) + '"><center><strong> CA' + c + 'F' + 'F' + b + '</strong><div style="background-color: '+colora+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +  datahoverItem[c]["F"][b] + '</tbody></table></div></td>';
                              } else {
                                
                                dataItems += '<td style="height:100px"><center><strong> CA' + c + 'F' + 'F' + b + '</strong><div style="background-color: '+colora+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + sum + '</b></div></center></td>';
                              }
                                  

                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                          dataBody.append(dataItems);
                          $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }
                } else if(room_value == "Rack B"){
                      let Brack = [5,4,3,2,1]
                      if(Type_value == "Level"){
                        console.log( "Data", DataRes)
                        var dataItems = '';
                        dataItems = '<tr>';
                        Brack.forEach(function(BItem) {

                          dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';

                        });
                        var datahoverItem = [];
                        for (b = 1; b <= 5; b++) {
                          dataItems += '<tr>';
                          for (c = 5; c >= 1; c--) {
                            for (a = 1; a >= 1; a--) {

                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["B"] !== 'undefined' && typeof DataRes[c]["B"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["B"][b]) == 0) {
                                  var sumA = 0;
                                } else {
                                  var sumA = parseInt(DataRes[c]["B"][b]);
                                }
                              } else {
                                var sumA = 0; 
                              }


                              if (DataRes?.prd_data_name?.[c]?.["B"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["B"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["B"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["B"]) {
                                          datahoverItem[c]["B"] = {};
                                        }

                                        datahoverItem[c]["B"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["B"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["B"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["B"][b] += '<tr>';
                                            
                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.product_code[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_name[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_qty[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';
                                            datahoverItem[c]["B"][b] += '</tr>';

                                          } 
                                        }
                                }


                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["F"] !== 'undefined' && typeof DataRes[c]["F"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["F"][b]) == 0) {
                                  var sumB = 0;
                                } else {
                                  var sumB = parseInt(DataRes[c]["F"][b]);
                                }
                              } else {
                                var sumB = 0; 
                              }


                              if (DataRes?.prd_data_name?.[c]?.["F"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["F"]) {
                                          datahoverItem[c]["F"] = {};
                                        }

                                        datahoverItem[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["F"][b] += '<tr>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.product_code[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';


                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            datahoverItem[c]["F"][b] += '</tr>';

                                          } 
                                        } 
                                }
                                var colora ;
                                console.log("color A", sumA + " <> " + "C" + c + 'F' + 'L' + b )
                                if(sumA > 0){
                                  colora = 'red'
                                }else{
                                  colora = 'green'
                                }

                                console.log("color B", sumB + " <> " + "C" + c + 'B' + 'L' + b )
                                var colorb ;
                                if(sumB > 0){
                                  colorb = 'red'
                                }else{
                                  colorb = 'green'
                                }
                                // console.log(datahoverItem[c]["F"][b])
                              dataItems += '<td style="height:100px">';
                              // dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CB' + c + 'F' + 'L' + b + '</strong> <div style="background-color: #f0f0f0; width: 200px; height: 25px; margin: 0 auto;"><b>' + sumB + '</b></div> </center></div>';
                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["F"] && datahoverItem[c]["F"][b]) {
                                console.log("asdasdas")
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["F"][b] ? true : false) +
                                  '"><center><strong> CB' +
                                  c +
                                  'F' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                    sumB +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["F"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CB' + c + 'F' + 'L' + b + '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumB + '</b></div> </center></div>';
                              }



                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["B"] && datahoverItem[c]["B"][b]) {
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["B"][b] ? true : false) +
                                  '"><center><strong> CB' +
                                  c +
                                  'B' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                  sumA +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["B"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CB' + c + 'B' + 'L' + b + '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumA + '</b></div></center></div>';
                              }
                            
                              dataItems += '</td>';

                            }
                          }
                          dataItems += '</tr>';
                        }

                        dataItems += '</tr>';
                        dataBody.append(dataItems);
                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });

                      }else if(Type_value == "Floor"){
                        console.log(DataRes)
                        var F = [];
                        var datahoverItem = []
                        for (let index = 1; index <= 4; index++) {
                          if (DataRes.length > 0 && DataRes[1] && DataRes[1]["S"] ) { 
                            
                              F[index] = DataRes[1]["S"][index] !== undefined ? DataRes[1]["S"][index] : 0;
                          } else {
                              F[index] = 0;
                          }


                        


                          if (DataRes && DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name[1]["S"]["Floor"][index]) &&
                              DataRes.prd_data_qty && Array.isArray(DataRes.prd_data_qty[1]["S"]["Floor"][index])) {

                              const numberOfProducts = DataRes.prd_data_name[1]["S"]["Floor"][index].length;
                              datahoverItem[index] = '';
                              
                              for (var x = 0; x <= numberOfProducts - 1; x++) {
                                  datahoverItem[index] += '<tr>';

                                  datahoverItem[index] += '<td>';
                                  datahoverItem[index] += DataRes.product_code[1]["S"]["Floor"][index][x];
                                  datahoverItem[index] += '</td>';
                                  
                                  datahoverItem[index] += '<td>';
                                  datahoverItem[index] += DataRes.prd_data_name[1]["S"]["Floor"][index][x];
                                  datahoverItem[index] += '</td>';

                                  datahoverItem[index] += '<td>';
                                  datahoverItem[index] += DataRes.prd_data_qty[1]["S"]["Floor"][index][x];
                                  datahoverItem[index] += '</td>';
                                  datahoverItem[index] += '</tr>';
                              }
                          } else {
                              datahoverItem[index] = '';
                              // console.log(`No data available for bay ${i}`);
                          }
                          
                        }

                        
                        var dataItems ='';
                        dataItems += '<tr>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="'+ (datahoverItem[1] ? true : false) + '"><center><strong>CB1SF1</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[1] +'</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="'+ (datahoverItem[3] ? true : false) + '"><center><strong>CB1SF3</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[3] +'</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataItems += '<tr>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="'+ (datahoverItem[2] ? true : false) + '"><center><strong>CB1SF2</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[2] +'</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="'+ (datahoverItem[4] ? true : false) + '"><center><strong>CB1SF4</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[4] +'</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataBody.append(dataItems);

                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }
                }else if(room_value == "Rack C"){
                      let Brack = [1,2,3,4,5]
                      if(Type_value == "Level"){
          
                        var dataItems = '';
                        dataItems = '<tr>';
                        Brack.forEach(function(BItem) {

                          dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';

                        });
                        var datahoverItem = []
                        for (b = 5; b >= 1; b--) {
                          dataItems += '<tr>';
                          for (c = 1; c <= 5; c++) {
                            for (a = 1; a >= 1; a--) {

                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["B"] !== 'undefined' && typeof DataRes[c]["B"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["B"][b]) == 0) {
                                  var sumA = 0;
                                } else {
                                  var sumA = parseInt(DataRes[c]["B"][b]);
                                }
                              } else {
                                var sumA = 0; 
                              }


                              if (DataRes?.prd_data_name?.[c]?.["B"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["B"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["B"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["B"]) {
                                          datahoverItem[c]["B"] = {};
                                        }

                                        datahoverItem[c]["B"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["B"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["B"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["B"][b] += '<tr>';
                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_name[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_qty[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';
                                            datahoverItem[c]["B"][b] += '</tr>';

                                          } 
                                        }
                                }


                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["F"] !== 'undefined' && typeof DataRes[c]["F"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["F"][b]) == 0) {
                                  var sumB = 0;
                                } else {
                                  var sumB = parseInt(DataRes[c]["F"][b]);
                                }
                              } else {
                                var sumB = 0; 
                              }

                              if (DataRes?.prd_data_name?.[c]?.["F"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["F"]) {
                                          datahoverItem[c]["F"] = {};
                                        }

                                        datahoverItem[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["F"][b] += '<tr>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.product_code[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            datahoverItem[c]["F"][b] += '</tr>';

                                          } 
                                        } 
                                }

                                var colora ;
                              if(sumA > 0){
                                colora = 'red'
                              }else{
                                colora = 'green'
                              }

                              var colorb ;
                              if(sumB > 0){
                                colorb = 'red'
                              }else{
                                colorb = 'green'
                              }
                              dataItems += '<td style="height:100px">';
                              // dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CC' + c + 'B' + 'L' + b + '</strong> <div style="background-color: #f0f0f0; width: 200px; height: 25px; margin: 0 auto;"><b>' + sumA + '</b></div> </center></div>';
                              // dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CC' + c + 'F' + 'L' + b + '</strong> <div style="background-color: #f0f0f0; width: 200px; height: 25px; margin: 0 auto;"><b>' + sumB + '</b></div></center></div>';
                              
                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["B"] && datahoverItem[c]["B"][b]) {
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["B"][b] ? true : false) +
                                  '"><center><strong> CC' +
                                  c +
                                  'B' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                  sumA +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["B"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CC' + c + 'B' + 'L' + b + '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumA + '</b></div></center></div>';
                              }


                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["F"] && datahoverItem[c]["F"][b]) {
                                
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["F"][b] ? true : false) +
                                  '"><center><strong> CC' +
                                  c +
                                  'F' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                    sumB +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["F"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CC' + c + 'F' + 'L' + b + '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumB + '</b></div> </center></div>';
                              }



                              
                              dataItems += '</td>';

                            }
                          }
                          dataItems += '</tr>';
                        }

                        dataItems += '</tr>';
                        dataBody.append(dataItems);

                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });


                      }else if(Type_value == "Floor"){
                        var F = [];
                        var datahoverItem = []
                        for (let index = 1; index <= 4; index++) {
                          F[index]  = DataRes[5] && DataRes[5].S && DataRes[5].S[index] !== undefined ? DataRes[5].S[index] : 0;


                            if (DataRes && DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name[5]["S"]["Floor"][index]) &&
                                  DataRes.prd_data_qty && Array.isArray(DataRes.prd_data_qty[5]["S"]["Floor"][index])) {

                                  const numberOfProducts = DataRes.prd_data_name[5]["S"]["Floor"][index].length;
                                  datahoverItem[index] = '';

                                  for (var x = 0; x <= numberOfProducts - 1; x++) {
                                      datahoverItem[index] += '<tr>';
                                      datahoverItem[index] += '<td>';

                                      // Check if prd_data_name[5]["S"]["Floor"][index][x] exists before accessing it
                                      if (DataRes.prd_data_name[5]["S"]["Floor"][index][x] !== undefined) {
                                          datahoverItem[index] += DataRes.prd_data_name[5]["S"]["Floor"][index][x];
                                      } else {
                                          datahoverItem[index] += 'N/A';
                                      }

                                      datahoverItem[index] += '</td>';
                                      datahoverItem[index] += '<td>';

                                      // Check if prd_data_qty[5]["S"]["Floor"][index][x] exists before accessing it
                                      if (DataRes.prd_data_qty[5]["S"]["Floor"][index][x] !== undefined) {
                                          datahoverItem[index] += DataRes.prd_data_qty[5]["S"]["Floor"][index][x];
                                      } else {
                                          datahoverItem[index] += 'N/A';
                                      }

                                      datahoverItem[index] += '</td>';
                                      datahoverItem[index] += '</tr>';
                                  }
                              } else {
                                  datahoverItem[index] = '';
                              }

                          
                        }

              
                        var dataItems = '';
                        dataItems += '<tr>';
                        dataItems += '<td colspan="5" rowspan="2"></td>';
                        dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) +'"><center><strong>CC5SF2</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[2] +'</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 150px"  id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) +'"><center><strong>CC5SF3</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[3] +'</tbody></table></div></td>';
                        dataItems += '</td>';


                        dataItems += '<tr>';
                          dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) +'"><center><strong >CC5SF1</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[1] +'</tbody></table></div></td>';
                          dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) +'"><center><strong>CC5SF4</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[4] +'</tbody></table></div></td>';
                        dataItems += '</tr>';


                          dataItems += '<tr>';
                            let Brack = [1,2,3,4,5]
                            Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem1 = []
                            for (b = 1; b >= 1; b--) {
                              dataItems += '<tr>';
                              for (c = 1; c <= 5; c++) {
                                for (a = 1; a >= 1; a--) {
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]?.F !== 'undefined' && typeof DataRes[c]?.F[b] !== 'undefined') {
                                      if (parseInt(DataRes[c]?.F[b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c]?.F[b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }  

                                  
                              if (DataRes?.prd_data_name?.[c]?.["F"]?.["Floor"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Floor"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Floor"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem1[c]) {
                                          datahoverItem1[c] = {};
                                        }

                                        if (!datahoverItem1[c]["F"]) {
                                          datahoverItem1[c]["F"] = {};
                                        }

                                        datahoverItem1[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Floor"] &&
                                            DataRes.prd_data_name[c]["F"]["Floor"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Floor"] &&
                                            DataRes.prd_data_qty[c]["F"]["Floor"][b]
                                          ) {
                                            datahoverItem1[c]["F"][b] += '<tr>';

                                            
                                            datahoverItem1[c]["F"][b] += '<td>';
                                            datahoverItem1[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Floor"][b][x];
                                            datahoverItem1[c]["F"][b] += '</td>';

                                            datahoverItem1[c]["F"][b] += '<td>';
                                              datahoverItem1[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Floor"][b][x];
                                            datahoverItem1[c]["F"][b] += '</td>';
                                            datahoverItem1[c]["F"][b] += '</tr>';

                                          } 
                                        } 
                                }
                                    
                                if (datahoverItem1 && datahoverItem1[c] && datahoverItem1[c]["F"] && datahoverItem1[c]["F"][b]) {
                                                        dataItems += '<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' +(datahoverItem1[c]["F"][b] ? true : false) +'"><center><strong> CC' + c + 'F' + 'F' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +datahoverItem1[c]["F"][b] +'</tbody></table></div></td>';
                              } else {
                                
                                dataItems += '<td style="height:100px"><center><strong> CC' + c + 'F' + 'F' + b + '</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';
                              }

                                    

                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                          dataBody.append(dataItems);
                          $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }
                } else if(room_value == "Rack D"){
                      let Brack = [5,4,3,2,1]
                      if(Type_value == "Level"){
          
                        var dataItems = '';
                        dataItems = '<tr>';
                        Brack.forEach(function(BItem) {

                          dataItems += '<td colspan="1" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';

                        });
                        var datahoverItem = [];
                        for (b = 1; b <= 5; b++) {
                          dataItems += '<tr>';
                          for (c = 5; c >= 1; c--) {
                            for (a = 1; a >= 1; a--) {

                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["B"] !== 'undefined' && typeof DataRes[c]["B"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["B"][b]) == 0) {
                                  var sumA = 0;
                                } else {
                                  var sumA = parseInt(DataRes[c]["B"][b]);
                                }
                              } else {
                                var sumA = 0; 
                              }


                              if (DataRes?.prd_data_name?.[c]?.["B"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["B"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["B"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["B"]) {
                                          datahoverItem[c]["B"] = {};
                                        }

                                        datahoverItem[c]["B"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["B"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"] &&
                                            DataRes.prd_data_name[c]["B"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["B"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"] &&
                                            DataRes.prd_data_qty[c]["B"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["B"][b] += '<tr>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.product_code[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';


                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_name[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';

                                            datahoverItem[c]["B"][b] += '<td>';
                                            datahoverItem[c]["B"][b] += DataRes.prd_data_qty[c]["B"]["Level"][b][x];
                                            datahoverItem[c]["B"][b] += '</td>';
                                            datahoverItem[c]["B"][b] += '</tr>';

                                          } 
                                        }
                                }


                              if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c]["F"] !== 'undefined' && typeof DataRes[c]["F"][b] !== 'undefined') {
                                if (parseInt(DataRes[c]["F"][b]) == 0) {
                                  var sumB = 0;
                                } else {
                                  var sumB = parseInt(DataRes[c]["F"][b]);
                                }
                              } else {
                                var sumB = 0; 
                              }


                              if (DataRes?.prd_data_name?.[c]?.["F"]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c]["F"]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c]["F"]["Level"][b].length;
                                        
                                        // alert(florArea)
                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c]["F"]) {
                                          datahoverItem[c]["F"] = {};
                                        }

                                        datahoverItem[c]["F"][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c]["F"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"] &&
                                            DataRes.prd_data_name[c]["F"]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c]["F"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"] &&
                                            DataRes.prd_data_qty[c]["F"]["Level"][b]
                                          ) {
                                            datahoverItem[c]["F"][b] += '<tr>';

                                            
                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.product_code[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';


                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_name[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';

                                            datahoverItem[c]["F"][b] += '<td>';
                                            datahoverItem[c]["F"][b] += DataRes.prd_data_qty[c]["F"]["Level"][b][x];
                                            datahoverItem[c]["F"][b] += '</td>';
                                            datahoverItem[c]["F"][b] += '</tr>';

                                          } 
                                        } 
                                }

                                var colora ;
                                if(sumA > 0){
                                  colora = 'red'
                                }else{
                                  colora = 'green'
                                }


                                var colorb ;
                                if(sumB > 0){
                                  colorb = 'red'
                                }else{
                                  colorb = 'green'
                                }

                              dataItems += '<td style="height:100px">';
                                                  
                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["F"] && datahoverItem[c]["F"][b]) {
                                
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["F"][b] ? true : false) +
                                  '"><center><strong> CD' +
                                  c +
                                  'F' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                    sumB +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["F"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CD' + c + 'F' + 'L' + b + '</strong> <div style="background-color: '+colorb+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumB + '</b></div> </center></div>';
                              }



                              if (datahoverItem && datahoverItem[c] && datahoverItem[c]["B"] && datahoverItem[c]["B"][b]) {
                                dataItems +=
                                  '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"  id="text-to-hover" class="button-text contactme" data-has-data="' +
                                  (datahoverItem[c]["B"][b] ? true : false) +
                                  '"><center><strong> CD' +
                                  c +
                                  'B' +
                                  'L' +
                                  b +
                                  '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' +
                                  sumA +
                                  '</b></div> </center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                  datahoverItem[c]["B"][b] +
                                  '</tbody></table></div></div>';
                              } else {
                                
                                dataItems += '<div style="width: 200px; height: 50px; margin: 0 auto; border: 0.5px solid black;"><center><strong> CD' + c + 'B' + 'L' + b + '</strong> <div style="background-color: '+colora+'; width: 200px; height: 25px; margin: 0 auto;"><b style="color:white">' + sumA + '</b></div></center></div>';
                              }


                              
                              dataItems += '</td>';

                            }
                          }
                          dataItems += '</tr>';
                        }

                        dataItems += '</tr>';
                        dataBody.append(dataItems);

                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });


                      }else if(Type_value == "Floor"){


                        var F = [];
                        var datahoverItem = []
                        for (let index = 1; index <= 4; index++) {
                          F[index]  = DataRes[5] && DataRes[5].S && DataRes[5].S[index] !== undefined ? DataRes[5].S[index] : 0;

                            

                            if (DataRes && DataRes.prd_data_name && DataRes.prd_data_name[5] &&
                              DataRes.prd_data_name[5]["S"] && DataRes.prd_data_name[5]["S"]["Floor"] &&
                              Array.isArray(DataRes.prd_data_name[5]["S"]["Floor"][index]) &&
                              DataRes.prd_data_qty && DataRes.prd_data_qty[5] &&
                              DataRes.prd_data_qty[5]["S"] && DataRes.prd_data_qty[5]["S"]["Floor"] &&
                              Array.isArray(DataRes.prd_data_qty[5]["S"]["Floor"][index])) {

                              const numberOfProducts = DataRes.prd_data_name[5]["S"]["Floor"][index].length;
                              datahoverItem[index] = '';

                              for (var x = 0; x <= numberOfProducts - 1; x++) {
                                  datahoverItem[index] += '<tr>';
                                  datahoverItem[index] += '<td>';

                                  if (DataRes.prd_data_name[5]["S"]["Floor"][index][x] !== undefined) {
                                      datahoverItem[index] += DataRes.prd_data_name[5]["S"]["Floor"][index][x];
                                  } else {
                                      datahoverItem[index] += 'N/A';
                                  }

                                  datahoverItem[index] += '</td>';
                                  datahoverItem[index] += '<td>';

                                  if (DataRes.prd_data_qty[5]["S"]["Floor"][index][x] !== undefined) {
                                      datahoverItem[index] += DataRes.prd_data_qty[5]["S"]["Floor"][index][x];
                                  } else {
                                      datahoverItem[index] += 'N/A';
                                  }

                                  datahoverItem[index] += '</td>';
                                  datahoverItem[index] += '</tr>';
                              }
                          } else {
                              datahoverItem[index] = '';
                              // console.log(`No data available for bay ${i}`);
                          }

                          
                        }
                        var color1;
                        var color2;
                        var color3;
                        var color4;

                        if(F[1] > 0){
                          color1 = "red";
                        }else{
                          color1 = "green";
                        }

                        if(F[2] > 0){
                          color2 = "red";
                        }else{
                          color2 = "green";
                        }

                        if(F[3] > 0){
                          color3 = "red";
                        }else{
                          color3 = "green";
                        }

                        if(F[4] > 0){
                          color4 = "red";
                        }else{
                          color4 = "green";
                        }

                        var dataItems ='';
                        dataItems += '<tr>';
                        dataItems += '<td style="background-color: '+color2+'; style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) +'"><center><strong>CD5SF2</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[2] + '</b></div></center> <div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[2] +'</tbody></table></div></td>';
                        dataItems += '<td style="background-color: '+color3+';  style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) +'"><center><strong>CD5SF3</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[3] +'</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataItems += '<tr>';
                        dataItems += '<td style="background-color: '+color1+'; style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) +'"><center><strong>CD5SF1</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[1] +'</tbody></table></div></td>';
                        dataItems += '<td style="background-color: '+color4+'; style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) +'"><center><strong>CD5SF4</strong><div style="background-color: #f0f0f0; width: 50px; height: 50px; margin: 0 auto;"><b>' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' + datahoverItem[4] +'</tbody></table></div></td>';
                        dataItems += '</tr>';
                        dataBody.append(dataItems);
                        $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }
                }else if(room_value == "Rack E"){
                  let Brack = [4,3,2,1]
                      if(Type_value == "Level"){
                        var dataItems = '';
                            dataItems = '<tr>';
                              Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem = []
                            for (b = 1; b <= 5; b++) {
                              dataItems += '<tr>';
                              for (c = 4; c >= 1; c--) {
                                for (a = 2; a >= 1; a--) {
                                  
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                      if (parseInt(DataRes[c][a][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c][a][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }


                                    if (DataRes?.prd_data_name?.[c]?.[a]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c][a]["Level"][b].length;


                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c][a]) {
                                          datahoverItem[c][a] = {};
                                        }

                                        datahoverItem[c][a][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c][a] &&
                                            DataRes.prd_data_name[c][a]["Level"] &&
                                            DataRes.prd_data_name[c][a]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c][a] &&
                                            DataRes.prd_data_qty[c][a]["Level"] &&
                                            DataRes.prd_data_qty[c][a]["Level"][b]
                                          ) {
                                            datahoverItem[c][a][b] += '<tr>';
                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';
                                            datahoverItem[c][a][b] += '</tr>';

                                          } 
                                        }
                                    
                                      }

                                      var color;

                                      if(sum > 0){
                                        color = "red";
                                      }else{
                                        color = "green";
                                      }

                                      if (datahoverItem && datahoverItem[c] &&datahoverItem[c][a] &&datahoverItem[c][a][b]) {
                                      dataItems +='<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' +(datahoverItem[c][a][b] ? true : false) +'"><center><strong> CE' + c +
                                        a +'L' +b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b>' +sum +
                                        '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                        datahoverItem[c][a][b] +
                                        '</tbody></table></div></td>';
                                    }else{
                                      dataItems += '<td style="height:100px"><center><strong> CE' + c + a + 'L' + b + '</strong><div style="background-color: '+color+';  width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';
                                    }
                                  
                                  
                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                            dataBody.append(dataItems);
                            $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                      }else if(Type_value == "Floor"){
                          var dataItems = '';
                          dataItems = '<tr>';
                            Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem =[]
                            for (b = 1; b <= 1; b++) {
                              dataItems += '<tr>';
                              for (c = 4; c >= 1; c--) {
                                for (a = 2; a >= 1; a--) {
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                      if (parseInt(DataRes[c][a][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c][a][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }


                                    if (DataRes?.prd_data_name?.[c]?.[a]?.["Floor"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Floor"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c][a]["Floor"][b].length;


                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c][a]) {
                                          datahoverItem[c][a] = {};
                                        }

                                        datahoverItem[c][a][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c][a] &&
                                            DataRes.prd_data_name[c][a]["Floor"] &&
                                            DataRes.prd_data_name[c][a]["Floor"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c][a] &&
                                            DataRes.prd_data_qty[c][a]["Floor"] &&
                                            DataRes.prd_data_qty[c][a]["Floor"][b]
                                          ) {
                                            datahoverItem[c][a][b] += '<tr>';
                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Floor"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Floor"][b][x];
                                            datahoverItem[c][a][b] += '</td>';
                                            datahoverItem[c][a][b] += '</tr>';

                                          } 
                                        }
                                    
                                      }
                                      var color;

                                      if(sum > 0){
                                        color = "red";
                                      }else{
                                        color = "green";
                                      }

                                      if (datahoverItem && datahoverItem[c] &&datahoverItem[c][a] &&datahoverItem[c][a][b]) {
                                      dataItems +='<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' +(datahoverItem[c][a][b] ? true : false) +'"><center><strong> CE' + c +
                                        a +'F' +b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b>' +sum +
                                        '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                        datahoverItem[c][a][b] +
                                        '</tbody></table></div></td>';
                                        console.log("adasdas")
                                    }else{
                                      
                                      dataItems += '<td style="height:100px"><center><strong> CE' + c + a + 'F' + b + '</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';
                                    }
                                  

                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                          dataBody.append(dataItems);

                          $(document).ready(function () {
                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                            });
                        }
                    
                    }else if(room_value == "Rack F"){
                  let Brack = [1,2,3]
                      if(Type_value == "Level"){
                        var dataItems = '';
                            dataItems = '<tr>';
                              Brack.forEach(function(BItem) {
                              
                              dataItems += '<td colspan="2" style="width: 400px;" ><center><strong>Bay' + BItem + ' </strong></center></td>';
                            
                            });
                            var datahoverItem = [];
                            for (b = 1; b <= 5; b++) {
                              dataItems += '<tr>';
                              for (c = 1; c <= 3; c++) {
                                for (a = 1; a <= 2; a++) {
                                  
                                    if (typeof DataRes[c] !== 'undefined' && typeof DataRes[c][a] !== 'undefined' && typeof DataRes[c][a][b] !== 'undefined') {
                                      if (parseInt(DataRes[c][a][b]) == 0) {
                                        var sum = 0;
                                      } else {
                                        var sum = parseInt(DataRes[c][a][b]);
                                      }
                                    } else {
                                      var sum = 0; 
                                    }

                                    if (DataRes?.prd_data_name?.[c]?.[a]?.["Level"]?.[b] && Array.isArray(DataRes.prd_data_name[c][a]["Level"][b])) {
                                        const numberOfProducts = DataRes.prd_data_name[c][a]["Level"][b].length;


                    
                                        if (!datahoverItem[c]) {
                                          datahoverItem[c] = {};
                                        }

                                        if (!datahoverItem[c][a]) {
                                          datahoverItem[c][a] = {};
                                        }

                                        datahoverItem[c][a][b] = '';

                                        for (var x = 0; x <= numberOfProducts - 1; x++) {
                                          if (
                                            DataRes &&
                                            DataRes.prd_data_name &&
                                            DataRes.prd_data_name[c] &&
                                            DataRes.prd_data_name[c][a] &&
                                            DataRes.prd_data_name[c][a]["Level"] &&
                                            DataRes.prd_data_name[c][a]["Level"][b] &&
                                            DataRes.prd_data_qty &&
                                            DataRes.prd_data_qty[c] &&
                                            DataRes.prd_data_qty[c][a] &&
                                            DataRes.prd_data_qty[c][a]["Level"] &&
                                            DataRes.prd_data_qty[c][a]["Level"][b]
                                          ) {
                                            datahoverItem[c][a][b] += '<tr>';
                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_name[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';

                                            datahoverItem[c][a][b] += '<td>';
                                            datahoverItem[c][a][b] += DataRes.prd_data_qty[c][a]["Level"][b][x];
                                            datahoverItem[c][a][b] += '</td>';
                                            datahoverItem[c][a][b] += '</tr>';

                                          } 
                                        }
                                    
                                      }

                                      var color;

                                      if(sum > 0){
                                        color = "red";
                                      }else{
                                        color = "green";
                                      }


                                      if (datahoverItem && datahoverItem[c] &&datahoverItem[c][a] &&datahoverItem[c][a][b]) {
                                      dataItems +='<td style="height:100px" id="text-to-hover" class="button-text contactme" data-has-data="' +(datahoverItem[c][a][b] ? true : false) +'"><center><strong> CF' + c +
                                        a +'L' +b +'</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b>' +sum +
                                        '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Product Name</td><td>Qty</td></tr></thead><tbody>' +
                                        datahoverItem[c][a][b] +
                                        '</tbody></table></div></td>';
                                  
                                    }else{
                                      
                                      dataItems += '<td style="height:100px"><center><strong> CF' + c + a + 'L' + b + '</strong><div style="background-color: '+color+'; width: 50px; height: 50px; margin: 0 auto;"><b>' + sum + '</b></div></center></td>';
                                    }
                                    
                                  
                                }
                              }
                              dataItems += '</tr>';
                            }

                            dataItems += '</tr>';
                            dataBody.append(dataItems);

                            $(".button-text.contactme").hover(function () {
                                  // alert($(this).data("has-data"))
                                    if ($(this).data("has-data") === true) {
                                        $(this).find('.emailcontainer').show('slow');
                                    }
                                }, function () {
                                    $(this).find('.emailcontainer').hide('slow');
                                });
                          
                          
                      }
                    }
                break;   
              }
        
            }

          break;

          case "finish":
          
          if(B_value == "All"){
            
            switch(warehouse_value) {
              
                case "DRY GOODS":
                  if(room_value == "Rack 1"){
                    var F = [];
                    var datahoverItem = [];
                    
                    for (var i = 1; i <= 16; i++) {
                      F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;


                      
                      if (DataRes.prd_data_name[i] && Array.isArray(DataRes.prd_data_name[i])) {
                        const numberOfProducts = DataRes.prd_data_name[i].length;
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'


                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'
                          var NumData = 0;
                            if(DataRes.prd_data_qty[i][x] > 0){
                              NumData = formatNumber(DataRes.prd_data_qty[i][x]);
                            }
                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += NumData
                          datahoverItem[i] += '</td>'
           
                          
                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '</tr>'
                          
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                        // console.log(`No data available for bay ${i}`);
                      }
                      
                      
                    }

                    var dataItems ='';
                    dataItems += '<tr>';
                      var color;
                      if(F[8] > 0){ color8 = 'red' }else{ color8 = 'green' }
                      if(F[16] > 0){ color16 = 'red' }else{ color16 = 'green' }
                     
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[8] ? true : false) + '"><center><strong>DG08</strong><div style="background-color: '+ color8 +'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[8] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[8] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[16] ? true : false) + '"><center><strong>DG16</strong><div style="background-color: '+color16+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[16] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[16] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[7] > 0){ color7 = 'red' }else{ color7 = 'green' }
                    if(F[15] > 0){ color15 = 'red' }else{ color15 = 'green' }



                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[7] ? true : false) + '"><center><strong>DG07</strong><div style="background-color: '+color7+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[7] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[7] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[15] ? true : false) + '"><center><strong>DG15</strong><div style="background-color: '+color15+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[15] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[15] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[6] > 0){ color6 = 'red' }else{ color6 = 'green' }
                    if(F[14] > 0){ color14 = 'red' }else{ color14 = 'green' }


                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[6] ? true : false) + '"><center><strong>DG06</strong><div style="background-color: '+color6+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[6] + '</b></div></center> <div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[6] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[14] ? true : false) + '"><center><strong>DG14</strong><div style="background-color: '+color14+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[14] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[14] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[5] > 0){ color5 = 'red' }else{ color5 = 'green' }
                    if(F[13] > 0){ color13 = 'red' }else{ color13 = 'green' }


                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[5] ? true : false) + '"><center><strong>DG05</strong><div style="background-color: '+color5+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[5] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[5] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[13] ? true : false) + '"><center><strong>DG13</strong><div style="background-color: '+color13+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[13] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[13] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[4] > 0){ color4 = 'red' }else{ color4 = 'green' }
                    if(F[12] > 0){ color12 = 'red' }else{ color12 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) + '"><center><strong>DG04</strong><div style="background-color: '+color4+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[4] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[12] ? true : false) + '"><center><strong>DG12</strong><div style="background-color: '+color12+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[12] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[12] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[3] > 0){ color3 = 'red' }else{ color3 = 'green' }
                    if(F[11] > 0){ color11 = 'red' }else{ color11 = 'green' }


                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) + '"><center><strong>DG03</strong><div style="background-color: '+color3+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[3] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[11] ? true : false) + '"><center><strong>DG11</strong><div style="background-color: '+color11+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[11] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[11] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    if(F[2] > 0){ color2 = 'red' }else{ color2 = 'green' }
                    if(F[10] > 0){ color10 = 'red' }else{ color10 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) + '"><center><strong>DG02</strong><div style="background-color: '+color2+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[2] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[10] ? true : false) + '"><center><strong>DG10</strong><div style="background-color: '+color10+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[10] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[10] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                      if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                      if(F[9] > 0){ color9 = 'red' }else{ color9 = 'green' }
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong>DG01</strong><div style="background-color: '+color1+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[9] ? true : false) + '"><center><strong>DG09</strong><div style="background-color: '+color9+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[9] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[9] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataBody.append(dataItems);

                  



                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });


                   
                  

                  }else if(room_value == "Rack 2"){
                    var dataItems ='';
                    var F = [];
                    var datahoverItem = [];
                    for (var i = 17; i <= 32; i++) {
                      F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                      if (DataRes.prd_data_name[i] && Array.isArray(DataRes.prd_data_name[i])) {
                        const numberOfProducts = DataRes.prd_data_name[i].length;
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'
                          
                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }
                      
                    }
                  
                    dataItems += '<tr>';

                    dataItems += '</tr>';

                    if(F[24] > 0){ color24 = 'red' }else{ color24 = 'green' }
                    if(F[32] > 0){ color32 = 'red' }else{ color32 = 'green' }
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[24] ? true : false) + '"><center><strong>DG24</strong><div style="background-color: '+color24+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[24] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[24] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[32] ? true : false) + '"><center><strong>DG32</strong><div style="background-color: '+color32+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[32] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[32] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    if(F[23] > 0){ color23 = 'red' }else{ color23 = 'green' }
                    if(F[31] > 0){ color31 = 'red' }else{ color31 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[23] ? true : false) + '"><center><strong>DG23</strong><div style="background-color: '+color23+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[23] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[23] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[31] ? true : false) + '"><center><strong>DG31</strong><div style="background-color: '+color31+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[31] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[31] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[22] > 0){ color22 = 'red' }else{ color22 = 'green' }
                    if(F[30] > 0){ color30 = 'red' }else{ color30 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[22] ? true : false) + '"><center><strong>DG22</strong><div style="background-color: '+color22+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[22] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[22] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[30] ? true : false) + '"><center><strong>DG30</strong><div style="background-color: '+color30+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[30] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[30] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[21] > 0){ color21 = 'red' }else{ color21 = 'green' }
                    if(F[29] > 0){ color29 = 'red' }else{ color29 = 'green' }


                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[21] ? true : false) + '"><center><strong>DG21</strong><div style="background-color: '+color21+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[21] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[21] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[29] ? true : false) + '"><center><strong>DG29</strong><div style="background-color: '+color29+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[29] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[29] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[20] > 0){ color20 = 'red' }else{ color20 = 'green' }
                    if(F[28] > 0){ color28 = 'red' }else{ color28 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[20] ? true : false) + '"><center><strong>DG20</strong><div style="background-color: '+color20+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[20] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[20] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[28] ? true : false) + '"><center><strong>DG28</strong><div style="background-color: '+color28+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[28] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[28] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    if(F[19] > 0){ color19 = 'red' }else{ color19 = 'green' }
                    if(F[27] > 0){ color27 = 'red' }else{ color27 = 'green' }
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[19] ? true : false) + '"><center><strong>DG19</strong><div style="background-color: '+color19+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[19] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[19] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[27] ? true : false) + '"><center><strong>DG27</strong><div style="background-color: '+color27+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[27] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[27] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    if(F[18] > 0){ color18 = 'red' }else{ color18 = 'green' }
                    if(F[26] > 0){ color26 = 'red' }else{ color26 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[18] ? true : false) + '"><center><strong>DG18</strong><div style="background-color: '+color18+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[18] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[18] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[26] ? true : false) + '"><center><strong>DG26</strong><div style="background-color: '+color26+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[26] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[26] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    if(F[17] > 0){ color17 = 'red' }else{ color17 = 'green' }
                    if(F[25] > 0){ color25 = 'red' }else{ color25 = 'green' }
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[17] ? true : false) + '"><center><strong>DG17</strong><div style="background-color: '+color17+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[17] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[17] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[25] ? true : false) + '"><center><strong>DG25</strong><div style="background-color: '+color25+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white" >' + F[25] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[25] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataBody.append(dataItems);

                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });


                  }else if(room_value == "All"){
              
                    var F = [];
                    var datahoverItem = [];

  
                    for (var i = 0; i <= 32; i++) {
                      F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                      if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length && typeof DataRes.prd_data_name[i] != undefined) {
                        // alert(DataRes.prd_data_qty[i])
                        var numberOfProducts = '';
                        if(typeof DataRes.prd_data_name[i] != "undefined"){
                          numberOfProducts = DataRes.prd_data_name[i].length;
                        }else{
                          numberOfProducts = 0;
                        }
                        
                        
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }
              
                      
                    }

                    var dataItems ='';
                    if(F[0] > 0){ color0 = 'red' }else{ color0 = 'green' }
      

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 100px" colspan="2" ><h1><center>Rack 1</center></h1></td>';
                    dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0] ? true : false) + '"><center><strong><h1>AISLE</h1></strong></center><br><center><strong><h1>(Staging Area - Inbound)</h1></strong></center><center><div style="background-color: '+color0+'; width: 200px; height: 200px; margin: 0 auto;" ><b style="color:white"><p style="font-size:100px">' + F[0] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[0] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 100px"colspan="2" ><h1><center>Rack 2</center></h1></td>';
                    dataItems += '</tr>';

                    if(F[8] > 0){ color8 = 'red' }else{ color8 = 'green' }
                    if(F[16] > 0){ color16 = 'red' }else{ color16 = 'green' }
                    if(F[24] > 0){ color24 = 'red' }else{ color24 = 'green' }
                    if(F[32] > 0){ color32 = 'red' }else{ color32 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[8] ? true : false) + '"><center><strong>DG08</strong><div style="background-color: '+color8+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[8] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[8] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[16] ? true : false) + '"><center><strong>DG16</strong><div style="background-color: '+color16+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[16] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[16] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[24] ? true : false) + '"><center><strong>DG24</strong><div style="background-color: '+color24+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[24] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[24] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[32] ? true : false) + '"><center><strong>DG32</strong><div style="background-color: '+color32+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[32] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[32] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[7] > 0){ color7 = 'red' }else{ color7 = 'green' }
                    if(F[15] > 0){ color15 = 'red' }else{ color15 = 'green' }
                    if(F[23] > 0){ color23 = 'red' }else{ color23 = 'green' }
                    if(F[31] > 0){ color31 = 'red' }else{ color31 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[7] ? true : false) + '"><center><strong>DG07</strong><div style="background-color: '+color7+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[7] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[7] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[15] ? true : false) + '"><center><strong>DG15</strong><div style="background-color: '+color15+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[15] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[15] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[23] ? true : false) + '"><center><strong>DG23</strong><div style="background-color: '+color23+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[23] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[23] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[31] ? true : false) + '"><center><strong>DG31</strong><div style="background-color: '+color31+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[31] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[31] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    if(F[6] > 0){ color6 = 'red' }else{ color6 = 'green' }
                    if(F[14] > 0){ color14 = 'red' }else{ color14 = 'green' }
                    if(F[22] > 0){ color22 = 'red' }else{ color22 = 'green' }
                    if(F[30] > 0){ color30 = 'red' }else{ color30 = 'green' }
                    
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[6] ? true : false) + '"><center><strong>DG06</strong><div style="background-color: '+color6+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[6] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[6] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[14] ? true : false) + '"><center><strong>DG14</strong><div style="background-color: '+color14+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[14] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[14] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[22] ? true : false) + '"><center><strong>DG22</strong><div style="background-color: '+color22+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[22] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[22] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[30] ? true : false) + '"><center><strong>DG30</strong><div style="background-color: '+color30+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[30] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[30] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[5] > 0){ color5 = 'red' }else{ color5 = 'green' }
                    if(F[13] > 0){ color13 = 'red' }else{ color13 = 'green' }
                    if(F[21] > 0){ color21 = 'red' }else{ color21 = 'green' }
                    if(F[29] > 0){ color29 = 'red' }else{ color29 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[5] ? true : false) + '"><center><strong>DG05</strong><div style="background-color: '+color5+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[5] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[5] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[13] ? true : false) + '"><center><strong>DG13</strong><div style="background-color: '+color13+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[13] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[13] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[21] ? true : false) + '"><center><strong>DG21</strong><div style="background-color: '+color21+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[21] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[21] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[29] ? true : false) + '"><center><strong>DG29</strong><div style="background-color: '+color29+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[29] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[29] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[4] > 0){ color4 = 'red' }else{ color4 = 'green' }
                    if(F[12] > 0){ color12 = 'red' }else{ color12 = 'green' }
                    if(F[20] > 0){ color20 = 'red' }else{ color20 = 'green' }
                    if(F[28] > 0){ color28 = 'red' }else{ color28 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) + '"><center><strong>DG04</strong><div style="background-color: '+color4+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[4] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[12] ? true : false) + '"><center><strong>DG12</strong><div style="background-color: '+color12+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[12] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[12] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[20] ? true : false) + '"><center><strong>DG20</strong><div style="background-color: '+color20+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[20] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[20] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[28] ? true : false) + '"><center><strong>DG28</strong><div style="background-color: '+color28+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[28] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[28] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[3] > 0){ color3 = 'red' }else{ color3 = 'green' }
                    if(F[11] > 0){ color11 = 'red' }else{ color11 = 'green' }
                    if(F[19] > 0){ color19 = 'red' }else{ color19 = 'green' }
                    if(F[27] > 0){ color27 = 'red' }else{ color27 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) + '"><center><strong>DG03</strong><div style="background-color: '+color3+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[3] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[11] ? true : false) + '"><center><strong>DG11</strong><div style="background-color: '+color11+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[11] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[11] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[19] ? true : false) + '"><center><strong>DG19</strong><div style="background-color: '+color19+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[19] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[19] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[27] ? true : false) + '"><center><strong>DG27</strong><div style="background-color: '+color27+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[27] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[27] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[2] > 0){ color2 = 'red' }else{ color2 = 'green' }
                    if(F[10] > 0){ color10 = 'red' }else{ color10 = 'green' }
                    if(F[18] > 0){ color18 = 'red' }else{ color18 = 'green' }
                    if(F[26] > 0){ color26 = 'red' }else{ color26 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) + '"><center><strong>DG02</strong><div style="background-color: '+color2+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[2] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[10] ? true : false) + '"><center><strong>DG10</strong><div style="background-color: '+color10+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[10] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[10] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[18] ? true : false) + '"><center><strong>DG18</strong><div style="background-color: '+color18+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[18] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[18] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[26] ? true : false) + '"><center><strong>DG26</strong><div style="background-color: '+color26+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[26] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[26] + '</tbody></table></div></td>';
                    dataItems += '</tr>';


                    if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                    if(F[9] > 0){ color9 = 'red' }else{ color9 = 'green' }
                    if(F[17] > 0){ color17 = 'red' }else{ color17 = 'green' }
                    if(F[25] > 0){ color25 = 'red' }else{ color25 = 'green' }

                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong>DG01</strong><div style="background-color: '+color1+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[9] ? true : false) + '"><center><strong>DG09</strong><div style="background-color: '+color9+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[9] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[9] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[17] ? true : false) + '"><center><strong>DG17</strong><div style="background-color: '+color17+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[17] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[17] + '</tbody></table></div></td>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[25] ? true : false) + '"><center><strong>DG25</strong><div style="background-color: '+color25+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[25] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[25] + '</tbody></table></div></td>';
                    dataItems += '</tr>';

                    dataBody.append(dataItems);


                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                  }else if(room_value == "AISLE"){

                    var F = [];
                    var datahoverItem = [];

  
                    for (var i = 0; i <= 32; i++) {
                        F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                        if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length && typeof DataRes.prd_data_name[i] != undefined) {
                          // alert(DataRes.prd_data_qty[i])
                          var numberOfProducts = '';
                          if(typeof DataRes.prd_data_name[i] != "undefined"){
                            numberOfProducts = DataRes.prd_data_name[i].length;
                          }else{
                            numberOfProducts = 0;
                          }
                          
                          
                          datahoverItem[i] = '';
                          for(var x=0; x <=numberOfProducts-1; x++){
                            
                            datahoverItem[i] += '<tr>'
                            
                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.product_code[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_name[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_qty[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.production_date[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.expiry_date[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.batch_code[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '</tr>'
                          }
                        
                        } else {
                          datahoverItem[i] = '';
                        }
              
                      
                    }

                    if(F[0] > 0){ color0 = 'red' }else{ color0 = 'green' }
                    var dataItems ='';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0] ? true : false) + '"><center><strong><h1>AISLE</h1></strong></center><br><center><strong><h1>(Staging Area - Inbound)</h1></strong></center><center><div style="background-color: '+color0+'; width: 200px; height: 200px; margin: 0 auto;" ><b style="color:white"><p style="font-size:100px">' + F[0] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[0] + '</tbody></table></div></td>';
                
                    dataItems += '</tr>';

                    
                    

                    


                    dataBody.append(dataItems);
                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                
                  }
                break;
                case "FROZEN GOODS":
                if(room_value == "Rack 1"){
                  var F = [];
                  var datahoverItem = [];
                  for (var i = 1; i <= 9; i++) {
                      F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;
                     
                      if (DataRes.prd_data_name[i] && Array.isArray(DataRes.prd_data_name[i]) ) {
                        const numberOfProducts = DataRes.prd_data_name[i].length;
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }
                    }

                    var dataItems ='';
                    dataItems += '<tr>';

                    dataItems += '</tr>';

                    if(F[9] > 0){ color9 = 'red' }else{ color9 = 'green' }
                    if(F[8] > 0){ color8 = 'red' }else{ color8 = 'green' }
                    if(F[7] > 0){ color7 = 'red' }else{ color7 = 'green' }
                    if(F[6] > 0){ color6 = 'red' }else{ color6 = 'green' }
                    if(F[5] > 0){ color5 = 'red' }else{ color5 = 'green' }
                    if(F[4] > 0){ color4 = 'red' }else{ color4 = 'green' }
                    if(F[3] > 0){ color3 = 'red' }else{ color3 = 'green' }
                    if(F[2] > 0){ color2 = 'red' }else{ color2 = 'green' }
                    if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[9] ? true : false) + '"><center><strong>FG09</strong><div style="background-color: '+color9+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[9] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[9] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[8] ? true : false) + '"><center><strong>FG08</strong><div style="background-color: '+color8+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[8] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[8] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[7] ? true : false) + '"><center><strong>FG07</strong><div style="background-color: '+color7+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[7] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[7] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[6] ? true : false) + '"><center><strong>FG06</strong><div style="background-color: '+color6+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[6] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[6] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[5] ? true : false) + '"><center><strong>FG05</strong><div style="background-color: '+color5+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[5] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[5] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) + '"><center><strong>FG04</strong><div style="background-color: '+color4+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[4] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) + '"><center><strong>FG03</strong><div style="background-color: '+color3+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[3] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) + '"><center><strong>FG02</strong><div style="background-color: '+color2+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[2] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong>FG01</strong><div style="background-color: '+color1+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                    dataItems += '</tr>';



                    dataBody.append(dataItems);


                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                    



                  }else if(room_value == "Rack 2"){
                    
                    var F = [];
                    var datahoverItem = [];
                    for (var i = 10; i <= 18; i++) {
                      F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                      if (DataRes.prd_data_name[i] && Array.isArray(DataRes.prd_data_name[i])) {
                        const numberOfProducts = DataRes.prd_data_name[i].length;
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'
                          
                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }

                    }
                    if(F[18] > 0){ color18 = 'red' }else{ color18 = 'green' }
                    if(F[17] > 0){ color17 = 'red' }else{ color17 = 'green' }
                    if(F[16] > 0){ color16 = 'red' }else{ color16 = 'green' }
                    if(F[15] > 0){ color15 = 'red' }else{ color15 = 'green' }
                    if(F[14] > 0){ color14 = 'red' }else{ color14 = 'green' }
                    if(F[13] > 0){ color13 = 'red' }else{ color13 = 'green' }
                    if(F[12] > 0){ color12 = 'red' }else{ color12 = 'green' }
                    if(F[11] > 0){ color11 = 'red' }else{ color11 = 'green' }
                    if(F[10] > 0){ color10 = 'red' }else{ color10 = 'green' }
                    var dataItems ='';
                    dataItems += '<tr>';

                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[18] ? true : false) + '"><center><strong>FG18</strong><div style="background-color: '+color18+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[18] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[18] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[17] ? true : false) + '"><center><strong>FG17</strong><div style="background-color: '+color17+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[17] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[17] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[16] ? true : false) + '"><center><strong>FG16</strong><div style="background-color: '+color16+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[16] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[16] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[15] ? true : false) + '"><center><strong>FG15</strong><div style="background-color: '+color15+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[15] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[15] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[14] ? true : false) + '"><center><strong>FG14</strong><div style="background-color: '+color14+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[14] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[14] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[13] ? true : false) + '"><center><strong>FG13</strong><div style="background-color: '+color13+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[13] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[13] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[12] ? true : false) + '"><center><strong>FG12</strong><div style="background-color: '+color12+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[12] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[12] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[11] ? true : false) + '"><center><strong>FG11</strong><div style="background-color: '+color11+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[11] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[11] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[10] ? true : false) + '"><center><strong>FG10</strong><div style="background-color: '+color10+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[10] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[10] + '</tbody></table></div></td>';
                    dataItems += '</tr>';
                    dataBody.append(dataItems);

                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                    


                  }else if(room_value == "All"){
                    var F = [];
                    var datahoverItem = [];
                    for (var i = 0; i <= 18; i++) {
                        F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                        if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length && typeof DataRes.prd_data_name[i] != undefined){
                          
                        // const numberOfProducts = DataRes.prd_data_name[i].length;
                        var numberOfProducts = '';
                        if(typeof DataRes.prd_data_name[i] != "undefined"){
                          numberOfProducts = DataRes.prd_data_name[i].length;
                        }else{
                          numberOfProducts = 0;
                        }

                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }
                  }

                      var dataItems ='';

                      if(F[0] > 0){ color0 = 'red' }else{ color0 = 'green' }
           
                      dataItems += '<tr>';
                        dataItems += '<td style="width: 200px; height: 100px"><h1><center>Rack 1</center></h1></td>';
                        dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0] ? true : false) + '"><center><strong><h1>AISLE</h1></strong></center><br><center><strong><h1>(Staging Area - Inbound)</h1></strong></center><center><div style="background-color: '+color0+'; width: 200px; height: 200px; margin: 0 auto;" ><b style="color:white"><p style="font-size:100px">' + F[0] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Product Name</td><td>Qty</td><td>Item Code</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[0] + '</tbody></table></div></td>';
                        dataItems += '<td style="width: 200px; height: 100px"><h1><center>Rack 2</center></h1></td>';
                      dataItems += '</tr>';
      
                      if(F[9] > 0){ color9 = 'red' }else{ color9 = 'green' }
                      if(F[18] > 0){ color18 = 'red' }else{ color18 = 'green' }
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[9] ? true : false) + '"><center><strong>FG09</strong><div style="background-color: '+color9+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[9] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[9] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[18] ? true : false) + '"><center><strong>FG18</strong><div style="background-color: '+color18+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[18] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[18] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[8] > 0){ color8 = 'red' }else{ color8 = 'green' }
                      if(F[17] > 0){ color17 = 'red' }else{ color17 = 'green' }
                      
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[8] ? true : false) + '"><center><strong>FG08</strong><div style="background-color: '+color8+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[8] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[8] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[17] ? true : false) + '"><center><strong>FG17</strong><div style="background-color: '+color17+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[17] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[17] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[7] > 0){ color7 = 'red' }else{ color7 = 'green' }
                      if(F[16] > 0){ color16 = 'red' }else{ color16 = 'green' }
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[7] ? true : false) + '"><center><strong>FG07</strong><div style="background-color:  '+color7+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[7] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[7] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[16] ? true : false) + '"><center><strong>FG16</strong><div style="background-color: '+color16+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[16] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[16] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[6] > 0){ color6 = 'red' }else{ color6 = 'green' }
                      if(F[15] > 0){ color15 = 'red' }else{ color15 = 'green' }
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[6] ? true : false) + '"><center><strong>FG06</strong><div style="background-color: '+color6+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[6] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[6] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[15] ? true : false) + '"><center><strong>FG15</strong><div style="background-color: '+color15+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[15] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[15] + '</tbody></table></div></td>';
                      dataItems += '</tr>';
                      if(F[5] > 0){ color5 = 'red' }else{ color5 = 'green' }
                      if(F[14] > 0){ color14 = 'red' }else{ color14 = 'green' }
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[5] ? true : false) + '"><center><strong>FG05</strong><div style="background-color: '+color5+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[5] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[5] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[14] ? true : false) + '"><center><strong>FG14</strong><div style="background-color: '+color14+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[14] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[14] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[4] > 0){ color4 = 'red' }else{ color4 = 'green' }
                      if(F[13] > 0){ color13 = 'red' }else{ color13 = 'green' }


                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[4] ? true : false) + '"><center><strong>FG04</strong><div style="background-color: '+color4+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[4] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[4] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[13] ? true : false) + '"><center><strong>FG13</strong><div style="background-color: '+color13+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[13] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[13] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[3] > 0){ color3 = 'red' }else{ color3 = 'green' }
                      if(F[12] > 0){ color12 = 'red' }else{ color12 = 'green' }


                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[3] ? true : false) + '"><center><strong>FG03</strong><div style="background-color: '+color3+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[3] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[3] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[12] ? true : false) + '"><center><strong>FG12</strong><div style="background-color: '+color12+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[12] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[12] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      if(F[2] > 0){ color2 = 'red' }else{ color2 = 'green' }
                      if(F[11] > 0){ color11 = 'red' }else{ color11 = 'green' }

                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[2] ? true : false) + '"><center><strong>FG02</strong><div style="background-color: '+color2+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[2] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[2] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[11] ? true : false) + '"><center><strong>FG11</strong><div style="background-color: '+color11+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[11] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[11] + '</tbody></table></div></td>';
                      dataItems += '</tr>';
                      if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                      if(F[10] > 0){ color10 = 'red' }else{ color10 = 'green' }

                      dataItems += '<tr>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong>FG01</strong><div style="background-color: '+color1+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[1] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                      dataItems += '<td style="width: 200px; height: 150px" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[10] ? true : false) + '"><center><strong>FG10</strong><div style="background-color: '+color10+'; width: 50px; height: 50px; margin: 0 auto;"><b style="color:white">' + F[10] + '</b></div></center><div class="emailcontainer"><table style="width: 100%;"><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[10] + '</tbody></table></div></td>';
                      dataItems += '</tr>';

                      dataBody.append(dataItems);

                      $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                  }else if(room_value == "AISLE"){
                    var F = [];
                    var datahoverItem = [];
                    for (var i = 0; i <= 18; i++) {
                        F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                        if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length) {
                        // const numberOfProducts = DataRes.prd_data_name[i].length;
                        var numberOfProducts = '';
                          if(typeof DataRes.prd_data_name[i] != "undefined"){
                            numberOfProducts = DataRes.prd_data_name[i].length;
                          }else{
                            numberOfProducts = 0;
                          }
                          
                        datahoverItem[i] = '';
                        for(var x=0; x <=numberOfProducts-1; x++){
                          
                          datahoverItem[i] += '<tr>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.product_code[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_name[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.prd_data_qty[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.production_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.expiry_date[i][x]
                          datahoverItem[i] += '</td>'

                          datahoverItem[i] += '<td>'
                          datahoverItem[i] += DataRes.batch_code[i][x]
                          datahoverItem[i] += '</td>'


                          datahoverItem[i] += '</tr>'
                        }
                      
                      } else {
                        datahoverItem[i] = '';
                      }
                  }
                  if(F[0] > 0){ color0 = 'red' }else{ color0 = 'green' }
                      var dataItems ='';
                      dataItems += '<tr>';
                      dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[0] ? true : false) + '"><center><strong><h1>AISLE</h1></strong></center><br><center><strong><h1>(Staging Area - Inbound)</h1></strong></center><center><div style="background-color: '+color0+'; width: 200px; height: 200px; margin: 0 auto;" ><b style="color:white"><p style="font-size:100px">' + F[0] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[0] + '</tbody></table></div></td>';
                      dataItems += '</tr>';
      
                     
                      dataBody.append(dataItems);

                      $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });

                  }
                  
                break;
            
                case "Antarctica":
                  if(room_value == "Frozen Goods"){

                    var F = [];
                    var datahoverItem = [];

  
                    for (var i = 0; i <= 32; i++) {
                        F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                        if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length && typeof DataRes.prd_data_name[i] != undefined) {
                          
                          var numberOfProducts = '';
                          if(typeof DataRes.prd_data_name[i] != "undefined"){
                            numberOfProducts = DataRes.prd_data_name[i].length;
                          }else{
                            numberOfProducts = 0;
                          }
                          
                          
                          datahoverItem[i] = '';
                          for(var x=0; x <=numberOfProducts-1; x++){
                            
                            datahoverItem[i] += '<tr>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.product_code[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_name[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_qty[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.production_date[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.expiry_date[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.batch_code[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '</tr>'
                          }
                        
                        } else {
                          datahoverItem[i] = '';
                        }
              
                      
                    }
                    var dataItems ='';
                    if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong><h1>ANTARCTICA</h1></strong></center><center><div style="background-color: '+color1+'; width: 200px; height: 200px; margin: 0 auto;" ><b style="color:white"><p style="font-size:100px">' + F[1] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                
                    dataItems += '</tr>';

                    
                    

                    


                    dataBody.append(dataItems);
                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                    console.log("asdasdas")
                  }
                break;
              
                case "Quality Inspection":
                  if(room_value == "Quality Assurance"){

                    var F = [];
                    var datahoverItem = [];

  
                    for (var i = 0; i <= 32; i++) {
                        F[i] = DataRes[i] !== undefined ? DataRes[i] : 0;

                        if (DataRes.prd_data_name && Array.isArray(DataRes.prd_data_name) && i >= 0 && i < DataRes.prd_data_name.length && typeof DataRes.prd_data_name[i] != undefined) {
                        
                          var numberOfProducts = '';
                          if(typeof DataRes.prd_data_name[i] != "undefined"){
                            numberOfProducts = DataRes.prd_data_name[i].length;
                          }else{
                            numberOfProducts = 0;
                          }
                          
                          
                          datahoverItem[i] = '';
                          for(var x=0; x <=numberOfProducts-1; x++){
                            
                            datahoverItem[i] += '<tr>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.product_code[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_name[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.prd_data_qty[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.production_date[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.expiry_date[i][x]
                            datahoverItem[i] += '</td>'

                            datahoverItem[i] += '<td>'
                            datahoverItem[i] += DataRes.batch_code[i][x]
                            datahoverItem[i] += '</td>'


                            datahoverItem[i] += '</tr>'
                          }
                        
                        } else {
                          datahoverItem[i] = '';
                        }
              
                      
                    }

                    if(F[1] > 0){ color1 = 'red' }else{ color1 = 'green' }
                    var dataItems ='';
                    dataItems += '<tr>';
                    dataItems += '<td style="width: 500px; height: 100px"rowspan="10" id="text-to-hover" class="button-text contactme" data-has-data="' + (datahoverItem[1] ? true : false) + '"><center><strong><h1>QUALITY INSPECTION</h1></strong></center><center><div style="background-color: '+color1+'; width: 200px; height: 200px; margin: 0 auto;" ><b><p style="font-size:100px">' + F[1] + '</p></b></div></center><div class="emailcontainer"><table style="width: 100%; background-color: rgb(141, 21, 21);" ><thead><tr><td>Item Code</td><td>Product Name</td><td>Qty</td><td>Production Date</td><td>Expiration Date</td><td>Batch Code</td></tr></thead><tbody>' + datahoverItem[1] + '</tbody></table></div></td>';
                
                    dataItems += '</tr>';

                    
                    

                    


                    dataBody.append(dataItems);
                    $(document).ready(function () {
                        $(".button-text.contactme").hover(function () {
                          // alert($(this).data("has-data"))
                            if ($(this).data("has-data") === true) {
                                $(this).find('.emailcontainer').show('slow');
                            }
                        }, function () {
                            $(this).find('.emailcontainer').hide('slow');
                        });
                    });
                    console.log("asdasdas")
                  }
                break;
              }
          }
          break
          

        }
        
        
        
      },
      error: function(error) {
        console.log('Error:', error);
      }
    });
  });
});




    </script>

        <!--**********************************
        Scripts end
    ***********************************-->
</body>

</html>